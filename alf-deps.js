!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ALF=t():e.ALF=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(9),l=n(o),u=t(11),c=n(u),h=t(12),f=n(h),d=t(10),p=t(15),g=n(p),m=t(21),v=n(m),_=t(27),y=n(_),b=t(57),w=n(b),E=t(60),T=n(E),x=t(61),S=n(x),C=t(26),P=n(C);exports["default"]={dom:a["default"],_:r["default"],hub:l["default"],Base:c["default"],View:f["default"],Events:d.Events,transition:g["default"],layer:v["default"],layout:y["default"],serialize:w["default"],compile:T["default"],nav:S["default"],util:P["default"]}},function(e,exports,t){(function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};(function(){function i(e,t,n){n=(n||0)-1;for(var i=e?e.length:0;++n<i;)if(e[n]===t)return n;return-1}function r(e,t){var r="undefined"==typeof t?"undefined":n(t);if(e=e.l,"boolean"==r||null==t)return e[t]?0:-1;"number"!=r&&"string"!=r&&(r="object");var s="number"==r?t:re+t;return e=(e=e[r])&&e[s],"object"==r?e&&-1<i(e,t)?0:-1:e?0:-1}function s(e){var t=this.l,i="undefined"==typeof e?"undefined":n(e);if("boolean"==i||null==e)t[e]=!0;else{"number"!=i&&"string"!=i&&(i="object");var r="number"==i?e:re+e,t=t[i]||(t[i]={});"object"==i?(t[r]||(t[r]=[])).push(e):t[r]=!0}}function a(e,t){for(var n=e.m,i=t.m,r=-1,s=n.length;++r<s;){var a=n[r],o=i[r];if(a!==o){if(a>o||"undefined"==typeof a)return 1;if(o>a||"undefined"==typeof o)return-1}}return e.n-t.n}function o(e){var t=-1,i=e.length,r=e[0],a=e[i/2|0],o=e[i-1];if(r&&"object"==("undefined"==typeof r?"undefined":n(r))&&a&&"object"==("undefined"==typeof a?"undefined":n(a))&&o&&"object"==("undefined"==typeof o?"undefined":n(o)))return!1;for(r=l(),r["false"]=r["null"]=r["true"]=r.undefined=!1,a=l(),a.k=e,a.l=r,a.push=s;++t<i;)a.push(e[t]);return a}function l(){return te.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function u(e){var t=e.l;t&&u(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,te.length<ae&&te.push(e)}function c(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);var i=-1;n=n-t||0;for(var r=Array(0>n?0:n);++i<n;)r[i]=e[t+i];return r}function h(e){return e instanceof h?e:new f(e)}function f(e,t){this.__chain__=!!t,this.__wrapped__=e}function d(e){function t(){if(i){var e=c(i);Ne.apply(e,arguments)}if(this instanceof t){var s=p(n.prototype),e=n.apply(s,e||arguments);return A(e)?e:s}return n.apply(r,e||arguments)}var n=e[0],i=e[2],r=e[4];return t}function p(e){return A(e)?Le(e):{}}function g(e,t,n){if("function"!=typeof e)return J;if("undefined"==typeof t||!("prototype"in e))return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,s){return e.call(t,n,i,r,s)}}return G(e,t)}function m(e){function t(){var e=l?a:this;if(r){var g=c(r);Ne.apply(g,arguments)}return(s||h)&&(g||(g=c(arguments)),s&&Ne.apply(g,s),h&&g.length<o)?(i|=16,m([n,f?i:-4&i,g,null,a,o])):(g||(g=arguments),u&&(n=e[d]),this instanceof t?(e=p(n.prototype),g=n.apply(e,g),A(g)?g:e):n.apply(e,g))}var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=1&i,u=2&i,h=4&i,f=8&i,d=n;return t}function v(e,t){var n=-1,s=T(),a=e?e.length:0,l=a>=se&&s===i,c=[];if(l){var h=o(t);h?(s=r,t=h):l=!1}for(;++n<a;)h=e[n],0>s(t,h)&&c.push(h);return l&&u(t),c}function _(e,t,i,r){r=(r||0)-1;for(var s=e?e.length:0,a=[];++r<s;){var o=e[r];if(o&&"object"==("undefined"==typeof o?"undefined":n(o))&&"number"==typeof o.length&&(He(o)||C(o))){t||(o=_(o,t,i));var l=-1,u=o.length,c=a.length;for(a.length+=u;++l<u;)a[c++]=o[l]}else i||a.push(o)}return a}function y(e,t,i,r){if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&ve["undefined"==typeof e?"undefined":n(e)]||t&&ve["undefined"==typeof t?"undefined":n(t)]))return!1;if(null==e||null==t)return e===t;var s=Ce.call(e),a=Ce.call(t);if(s!=a)return!1;switch(s){case ue:case ce:return+e==+t;case he:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case de:case pe:return e==t+""}if(a=s==le,!a){var o=e instanceof h,l=t instanceof h;if(o||l)return y(o?e.__wrapped__:e,l?t.__wrapped__:t,i,r);if(s!=fe)return!1;if(s=e.constructor,o=t.constructor,s!=o&&!(O(s)&&s instanceof s&&O(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}for(i||(i=[]),r||(r=[]),s=i.length;s--;)if(i[s]==e)return r[s]==t;var u=!0,c=0;if(i.push(e),r.push(t),a){if(c=t.length,u=c==e.length)for(;c--&&(u=y(e[c],t[c],i,r)););}else Ge(t,function(t,n,s){return Ae.call(s,n)?(c++,!(u=Ae.call(e,n)&&y(e[n],t,i,r))&&ie):void 0}),u&&Ge(e,function(e,t,n){return Ae.call(n,t)?!(u=-1<--c)&&ie:void 0});return i.pop(),r.pop(),u}function b(e){return function(t,n,i){var r={};n=q(n,i,3),i=-1;var s=t?t.length:0;if("number"==typeof s)for(;++i<s;){var a=t[i];e(r,a,n(a,i,t),t)}else Ve(t,function(t,i,s){e(r,t,n(t,i,s),s)});return r}}function w(e,t,n,i,r,s){var a=16&t,o=32&t;if(!(2&t||O(e)))throw new TypeError;return a&&!n.length&&(t&=-17,n=!1),o&&!i.length&&(t&=-33,i=!1),(1==t||17===t?d:m)([e,t,n,i,r,s])}function E(e){return Ue[e]}function T(){var e=(e=h.indexOf)===$?i:e;return e}function x(e){return"function"==typeof e&&Pe.test(e)}function S(e){var t,n;return e&&Ce.call(e)==fe&&(t=e.constructor,!O(t)||t instanceof t)?(Ge(e,function(e,t){n=t}),"undefined"==typeof n||Ae.call(e,n)):ie}function C(e){return e&&"object"==("undefined"==typeof e?"undefined":n(e))&&"number"==typeof e.length&&Ce.call(e)==oe||!1}function P(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t];if(i)for(var r in i)e[r]=i[r]}return e}function M(e){var t=[];return Ge(e,function(e,n){O(e)&&t.push(n)}),t.sort()}function O(e){return"function"==typeof e}function A(e){return!(!e||!ve["undefined"==typeof e?"undefined":n(e)])}function N(e){return"string"==typeof e||e&&"object"==("undefined"==typeof e?"undefined":n(e))&&Ce.call(e)==pe||!1}function I(e){for(var t=-1,n=ze(e),i=n.length,r=Array(i);++t<i;)r[t]=e[n[t]];return r}function L(e,t){var n=T(),i=e?e.length:0,r=!1;return i&&"number"==typeof i?r=-1<n(e,t):Ve(e,function(e){return(r=e===t)&&ie}),r}function R(e,t,n){var i=!0;t=q(t,n,3),n=-1;var r=e?e.length:0;if("number"==typeof r)for(;++n<r&&(i=!!t(e[n],n,e)););else Ve(e,function(e,n,r){return!(i=!!t(e,n,r))&&ie});return i}function F(e,t,n){var i=[];t=q(t,n,3),n=-1;var r=e?e.length:0;if("number"==typeof r)for(;++n<r;){var s=e[n];t(s,n,e)&&i.push(s)}else Ve(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function k(e,t,n){t=q(t,n,3),n=-1;var i=e?e.length:0;if("number"!=typeof i){var r;return Ve(e,function(e,n,i){return t(e,n,i)?(r=e,ie):void 0}),r}for(;++n<i;){var s=e[n];if(t(s,n,e))return s}}function j(e,t,n){var i=-1,r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:g(t,n,3),"number"==typeof r)for(;++i<r&&t(e[i],i,e)!==ie;);else Ve(e,t)}function D(e,t){var n=e?e.length:0;if("number"==typeof n)for(;n--&&!1!==t(e[n],n,e););else{var i=ze(e),n=i.length;Ve(e,function(e,r,s){return r=i?i[--n]:--n,!1===t(s[r],r,s)&&ie})}}function H(e,t,n){var i=-1,r=e?e.length:0;if(t=q(t,n,3),"number"==typeof r)for(var s=Array(r);++i<r;)s[i]=t(e[i],i,e);else s=[],Ve(e,function(e,n,r){s[++i]=t(e,n,r)});return s}function B(e,t,n,i){if(!e)return n;var r=3>arguments.length;t=q(t,i,4);var s=-1,a=e.length;if("number"==typeof a)for(r&&(n=e[++s]);++s<a;)n=t(n,e[s],s,e);else Ve(e,function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)});return n}function z(e,t,n,i){var r=3>arguments.length;return t=q(t,i,4),D(e,function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)}),n}function W(e,t,n){var i;t=q(t,n,3),n=-1;var r=e?e.length:0;if("number"==typeof r)for(;++n<r&&!(i=t(e[n],n,e)););else Ve(e,function(e,n,r){return(i=t(e,n,r))&&ie});return!!i}function U(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var s=-1;for(t=q(t,n,3);++s<r&&t(e[s],s,e);)i++}else if(i=t,null==i||n)return e?e[0]:Q;return c(e,0,je(ke(0,i),r))}function $(e,t,n){if("number"==typeof n){var r=e?e.length:0;n=0>n?ke(0,r+n):n||0}else if(n)return n=Y(e,t),e[n]===t?n:-1;return i(e,t,n)}function X(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,s=e?e.length:0;for(t=q(t,n,3);++r<s&&t(e[r],r,e);)i++}else i=null==t||n?1:ke(0,t);return c(e,i)}function Y(e,t,n,i){var r=0,s=e?e.length:r;for(n=n?q(n,i,1):J,t=n(t);s>r;)i=r+s>>>1,n(e[i])<t?r=i+1:s=i;return r}function G(e,t){return 2<arguments.length?w(e,17,c(arguments,2),null,t):w(e,1,null,null,t)}function V(e,t,n){var i,r,s,a,o,l,u,c=0,h=!1,f=!0;if(!O(e))throw new TypeError;if(t=ke(0,t)||0,!0===n)var d=!0,f=!1;else A(n)&&(d=n.leading,h="maxWait"in n&&(ke(t,n.maxWait)||0),f="trailing"in n?n.trailing:f);var p=function m(){var n=t-(Qe()-a);n>0?l=setTimeout(m,n):(r&&clearTimeout(r),n=u,r=l=u=Q,n&&(c=Qe(),s=e.apply(o,i),l||r||(i=o=null)))},g=function(){l&&clearTimeout(l),r=l=u=Q,(f||h!==t)&&(c=Qe(),s=e.apply(o,i),l||r||(i=o=null))};return function(){if(i=arguments,a=Qe(),o=this,u=f&&(l||!d),!1===h)var n=d&&!l;else{r||d||(c=a);var m=h-(a-c),v=0>=m;v?(r&&(r=clearTimeout(r)),c=a,s=e.apply(o,i)):r||(r=setTimeout(g,m))}return v&&l?l=clearTimeout(l):l||t===h||(l=setTimeout(p,t)),n&&(v=!0,s=e.apply(o,i)),!v||l||r||(i=o=null),s}}function q(e,t,i){var r="undefined"==typeof e?"undefined":n(e);if(null==e||"function"==r)return g(e,t,i);if("object"!=r)return K(e);var s=ze(e);return function(t){for(var n=s.length,i=!1;n--&&(i=t[s[n]]===e[s[n]]););return i}}function J(e){return e}function Z(e){j(M(e),function(t){var n=h[t]=e[t];h.prototype[t]=function(){var e=[this.__wrapped__];return Ne.apply(e,arguments),e=n.apply(h,e),this.__chain__?new f(e,!0):e}})}function K(e){return function(t){return t[e]}}var Q,ee=[],te=[],ne=0,ie={},re=+new Date+"",se=75,ae=40,oe="[object Arguments]",le="[object Array]",ue="[object Boolean]",ce="[object Date]",he="[object Number]",fe="[object Object]",de="[object RegExp]",pe="[object String]",ge={leading:!1,maxWait:0,trailing:!1},me={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:!1},ve={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},_e=ve["undefined"==typeof window?"undefined":n(window)]&&window||this,ye=ve[n(exports)]&&exports&&!exports.nodeType&&exports,be=ve[n(e)]&&e&&!e.nodeType&&e,we=be&&be.exports===ye&&ye,Ee=ve["undefined"==typeof t?"undefined":n(t)]&&t;!Ee||Ee.global!==Ee&&Ee.window!==Ee||(_e=Ee);var Te=[],xe=Object.prototype,Se=String.prototype,Ce=xe.toString,Pe=RegExp("^"+(Ce+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Me=Math.floor,Oe=x(Oe=Object.getPrototypeOf)&&Oe,Ae=xe.hasOwnProperty,Ne=Te.push,Ie=xe.propertyIsEnumerable,Le=x(Le=Object.create)&&Le,Re=x(Re=Array.isArray)&&Re,Fe=x(Fe=Object.keys)&&Fe,ke=Math.max,je=Math.min,De=Math.random;f.prototype=h.prototype;var $e={};!function(){var e={0:1,length:1};$e.spliceObjects=(Te.splice.call(e,0,1),!e[0])}(1),Le||(p=function(){function e(){}return function(t){if(A(t)){e.prototype=t;var n=new e;e.prototype=null}return n||_e.Object()}}()),C(arguments)||(C=function(e){return e&&"object"==("undefined"==typeof e?"undefined":n(e))&&"number"==typeof e.length&&Ae.call(e,"callee")&&!Ie.call(e,"callee")||!1});var He=Re||function(e){return e&&"object"==("undefined"==typeof e?"undefined":n(e))&&"number"==typeof e.length&&Ce.call(e)==le||!1},Be=function(e){var t,i=[];if(!e||!ve["undefined"==typeof e?"undefined":n(e)])return i;for(t in e)Ae.call(e,t)&&i.push(t);return i},ze=Fe?function(e){return A(e)?Fe(e):[]}:Be,We={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",v:ze,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},Ue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Xe=RegExp("["+ze(Ue).join("")+"]","g"),Ye=function(){me.b=me.c=me.g=me.i="",me.e="t",me.j=!0;for(var e,t=0;e=arguments[t];t++)for(var n in e)me[n]=e[n];t=me.a,me.d=/^[^,]+/.exec(t)[0],e=Function,t="return function("+t+"){",n=me;var i="var n,t="+n.d+",E="+n.e+";if(!t)return E;"+n.i+";";n.b&&(i+="var u=t.length;n=-1;if("+n.b+"){while(++n<u){"+n.g+";}}else{");var r=[];return n.j&&n.f?i+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];":(i+="for(n in t){",n.j&&r.push("m.call(t, n)")),r.length&&(i+="if("+r.join("&&")+"){"),i+=n.g+";",r.length&&(i+="}"),i+="}",n.b&&(i+="}"),i+=n.c+";return E",e("d,m,o,p,q,s,v,A,B,I,J,L",t+i+"}")(g,Ae,ie,C,He,N,me.f,xe,ve,pe,Se,Ce)}(We),Ge=function(e,t){var i;if(!e||!ve["undefined"==typeof e?"undefined":n(e)])return e;for(i in e)if(t(e[i],i,e)===ie)break;return e},Ve=function(e,t){var i;if(!e||!ve["undefined"==typeof e?"undefined":n(e)])return e;for(var r=-1,s=ve["undefined"==typeof e?"undefined":n(e)]&&ze(e),a=s?s.length:0;++r<a&&(i=s[r],t(e[i],i,e)!==ie););return e};O(/x/)&&(O=function(e){return"function"==typeof e&&"[object Function]"==Ce.call(e)});var qe=Oe?function(e){if(!e||Ce.call(e)!=fe)return!1;var t=e.valueOf,n=x(t)&&(n=Oe(t))&&Oe(n);return n?e==n||Oe(e)==n:S(e)}:S,Je=b(function(e,t,n){Ae.call(e,n)?e[n]++:e[n]=1}),Ze=b(function(e,t,n){(Ae.call(e,n)?e[n]:e[n]=[]).push(t)}),Ke=H,Qe=x(Qe=Date.now)&&Qe||function(){return(new Date).getTime()};h.bind=G,h.bindAll=function(e){for(var t=1<arguments.length?_(arguments,!0,!1,1):M(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=w(e[r],1,null,null,e)}return e},h.chain=function(e){return e=new f(e),e.__chain__=!0,e},h.countBy=Je,h.debounce=V,h.defaults=Ye,h.difference=function(e){return v(e,_(arguments,!0,!0,1))},h.filter=F,h.flatten=function(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(e=H(e,n,i)),_(e,t)},h.forEach=j,h.functions=M,h.groupBy=Ze,h.initial=function(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var s=r;for(t=q(t,n,3);s--&&t(e[s],s,e);)i++}else i=null==t||n?1:t||i;return c(e,0,je(ke(0,r-i),r))},h.intersection=function(){for(var e=[],t=-1,n=arguments.length,s=ee.pop()||[],a=T(),l=a===i,c=ee.pop()||[];++t<n;){var h=arguments[t];(He(h)||C(h))&&(e.push(h),s.push(l&&h.length>=se&&o(t?e[t]:c)))}var l=e[0],f=-1,d=l?l.length:0,p=[];e:for(;++f<d;){var g=s[0],h=l[f];if(0>(g?r(g,h):a(c,h))){for(t=n,(g||c).push(h);--t;)if(g=s[t],0>(g?r(g,h):a(e[t],h)))continue e;p.push(h)}}for(;n--;)(g=s[n])&&u(g);return s.length=0,ee.length<ae&&ee.push(s),c.length=0,ee.length<ae&&ee.push(c),p},h.invert=function(e){for(var t=-1,n=ze(e),i=n.length,r={};++t<i;){var s=n[t];r[e[s]]=s}return r},h.invoke=function(e,t){var n=c(arguments,2),i=-1,r="function"==typeof t,s=e?e.length:0,a=Array("number"==typeof s?s:0);return j(e,function(e){a[++i]=(r?t:e[t]).apply(e,n)}),a},h.keys=ze,h.map=H,h.max=function(e,t,n){var i=-1/0,r=i;"function"!=typeof t&&n&&n[t]===e&&(t=null);var s=-1,a=e?e.length:0;if(null==t&&"number"==typeof a)for(;++s<a;)n=e[s],n>r&&(r=n);else t=q(t,n,3),j(e,function(e,n,s){n=t(e,n,s),n>i&&(i=n,r=e)});return r},h.memoize=function(e,t){if(!O(e))throw new TypeError;var n=function i(){var n=i.cache,r=t?t.apply(this,arguments):re+arguments[0];return Ae.call(n,r)?n[r]:n[r]=e.apply(this,arguments)};return n.cache={},n},h.min=function(e,t,n){var i=1/0,r=i;"function"!=typeof t&&n&&n[t]===e&&(t=null);var s=-1,a=e?e.length:0;if(null==t&&"number"==typeof a)for(;++s<a;)n=e[s],r>n&&(r=n);else t=q(t,n,3),j(e,function(e,n,s){n=t(e,n,s),i>n&&(i=n,r=e)});return r},h.omit=function(e){var t=[];Ge(e,function(e,n){t.push(n)});for(var t=v(t,_(arguments,!0,!1,1)),n=-1,i=t.length,r={};++n<i;){var s=t[n];r[s]=e[s]}return r},h.once=function(e){var t,n;if(!O(e))throw new TypeError;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},h.pairs=function(e){for(var t=-1,n=ze(e),i=n.length,r=Array(i);++t<i;){var s=n[t];r[t]=[s,e[s]]}return r},h.pick=function(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,s=_(arguments,!0,!1,1),a=A(e)?s.length:0;++r<a;){var o=s[r];o in e&&(i[o]=e[o])}else t=q(t,n,3),Ge(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i},h.pluck=Ke,h.reject=function(e,t,n){return t=q(t,n,3),F(e,function(e,n,i){return!t(e,n,i)})},h.rest=X,h.shuffle=function(e){var t=-1,n=e?e.length:0,i=Array("number"==typeof n?n:0);return j(e,function(e){var n;n=++t,n=0+Me(De()*(n-0+1)),i[t]=i[n],i[n]=e}),i},h.sortBy=function(e,t,n){var i=-1,r=e?e.length:0,s=Array("number"==typeof r?r:0);for(t=q(t,n,3),j(e,function(e,n,r){s[++i]={m:[t(e,n,r)],n:i,o:e}}),r=s.length,s.sort(a);r--;)s[r]=s[r].o;return s},h.throttle=function(e,t,n){var i=!0,r=!0;if(!O(e))throw new TypeError;return!1===n?i=!1:A(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),ge.leading=i,ge.maxWait=t,ge.trailing=r,V(e,t,ge)},h.toArray=function(e){return He(e)?c(e):e&&"number"==typeof e.length?H(e):I(e)},h.values=I,h.without=function(e){return v(e,c(arguments,1))},h.collect=H,h.drop=X,h.each=j,h.extend=P,h.methods=M,h.select=F,h.tail=X,h.clone=function(e){return A(e)?He(e)?c(e):P({},e):e},h.contains=L,h.escape=function(e){return null==e?"":(e+"").replace(Xe,E)},h.every=R,h.find=k,h.has=function(e,t){return e?Ae.call(e,t):!1},h.identity=J,h.indexOf=$,h.isArguments=C,h.isArray=He,h.isEmpty=function(e){if(!e)return!0;if(He(e)||N(e))return!e.length;for(var t in e)if(Ae.call(e,t))return!1;return!0},h.isEqual=function(e,t){return y(e,t)},h.isFunction=O,h.isObject=A,h.isPlainObject=qe,h.isRegExp=function(e){return e&&ve["undefined"==typeof e?"undefined":n(e)]&&Ce.call(e)==de||!1},h.isString=N,h.lastIndexOf=function(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?ke(0,i+n):je(n,i-1))+1);i--;)if(e[i]===t)return i;return-1},h.mixin=Z,h.reduce=B,h.reduceRight=z,h.result=function(e,t){if(e){var n=e[t];return O(n)?e[t]():n}},h.size=function(e){var t=e?e.length:0;return"number"==typeof t?t:ze(e).length},h.some=W,h.sortedIndex=Y,h.uniqueId=function(e){var t=++ne+"";return e?e+t:t},h.all=R,h.any=W,h.detect=k,h.foldl=B,h.foldr=z,h.include=L,h.inject=B,h.first=U,h.last=function(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var s=r;for(t=q(t,n,3);s--&&t(e[s],s,e);)i++}else if(i=t,null==i||n)return e?e[r-1]:Q;return c(e,ke(0,r-i))},h.take=U,h.head=U,Z(h),h.VERSION="2.4.1",h.prototype.chain=function(){return this.__chain__=!0,this},h.prototype.value=function(){return this.__wrapped__},j("pop push reverse shift sort splice unshift".split(" "),function(e){var t=Te[e];h.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),$e.spliceObjects||0!==e.length||delete e[0],this}}),j(["concat","join","slice"],function(e){var t=Te[e];h.prototype[e]=function(){var e=t.apply(this.__wrapped__,arguments);return this.__chain__&&(e=new f(e),e.__chain__=!0),e}}),ye&&be?we?(be.exports=h)._=h:ye._=h:_e._=h}).call(void 0)}).call(exports,t(2)(e),function(){return this}())},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),t(4),t(7),t(8);var i=t(5),r=n(i);exports["default"]=r["default"]},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return"tagName"in e?e:e.parentNode}function r(e,t,n,i){var r=Math.abs(e-t),s=Math.abs(n-i);return r>=s?e-t>0?"Left":"Right":n-i>0?"Up":"Down"}function s(e){e=m[e],e.timeout&&clearTimeout(e.timeout),e.timeout=null}function a(){m.longTap.timeout=null,g.last&&(g.el.trigger("longTap"),g={})}function o(){m.active.timeout=null,g.last&&g.el.trigger("active")}function l(){s("longTap")}function u(){s("active")}function c(){var e,t,n,s,c,d=!1,v="ontouchstart"in window,_="touchstart",y="touchmove",b="touchend";v||(_="mousedown",y="mousemove",b="mouseup"),(0,p["default"])(document.body).bind(_,function(n){n=n.originalEvent||n,d=!0,c=v?n.touches[0]:n,e=Date.now(),t=e-(g.last||e),g.el=(0,p["default"])(i(c.target)),h&&clearTimeout(h),g.x1=c.pageX,g.y1=c.pageY,g.x2=c.pageX,g.y2=c.pageY,t>0&&250>=t&&(g.isDoubleTap=!0),g.last=e,m.longTap.timeout=setTimeout(a,m.longTap.delay),m.active.timeout=setTimeout(o,m.active.delay)}).bind(y,function(e){d&&(e=e.originalEvent||e,u(),l(),c=v?e.touches[0]:e,g.x2=c.pageX,g.y2=c.pageY,document.webkitPointerLockElement&&(d=!1))}).bind(b,function(e){d&&(d=!1,l(),u(),n=Math.abs(g.x1-g.x2),s=Math.abs(g.y1-g.y2),g.isDoubleTap?(g.el.trigger("doubleTap",g.el),g={}):n>30||s>30?(g.el.trigger("swipe")&&g.el.trigger("swipe"+r(g.x1,g.x2,g.y1,g.y2)),g={}):"last"in g&&7>n&&7>s&&(g.el.trigger("tap"),h=setTimeout(function(){h=null,g.el.trigger("singleTap"),g={}},250)))}).bind("touchcancel",function(){h&&clearTimeout(h),f&&clearTimeout(f),f=h=null,g={}})}var h,f,d=t(5),p=n(d),g={},m={longTap:{delay:750},active:{delay:0}};"undefined"!=typeof window&&(0,p["default"])(document).ready(c)},function(e,exports,t){"use strict";var $=t(6);e.exports=$},function(e,exports,t){var n=function(){function e(e){return null==e?String(e):Y[G.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function i(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(t){return"object"==e(t)}function s(e){return r(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function a(e){return"number"==typeof e.length}function o(e){return M.call(e,function(e){return null!=e})}function l(e){return e.length>0?$.fn.concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function c(e){return e in N?N[e]:N[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function h(e,t){return"number"!=typeof t||I[u(e)]?t:t+"px"}function f(e){var t,n;return A[e]||(t=O.createElement(e),O.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),A[e]=n),A[e]}function d(e){return"children"in e?P.call(e.children):$.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function p(e,t,n){for(E in t)n&&(s(t[E])||Z(t[E]))?(s(t[E])&&!s(e[E])&&(e[E]={}),Z(t[E])&&!Z(e[E])&&(e[E]=[]),p(e[E],t[E],n)):t[E]!==w&&(e[E]=t[E])}function g(e,t){return null==t?$(e):$(e).filter(t)}function m(e,n,i,r){return t(n)?n.call(e,i,r):n}function v(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function _(e,t){var n=e.className||"",i=n&&n.baseVal!==w;return t===w?i?n.baseVal:n:void(i?n.baseVal=t:e.className=t)}function y(e){try{return e?"true"==e||("false"==e?!1:"null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?$.parseJSON(e):e):e}catch(t){return e}}function b(e,t){t(e);for(var n=0,i=e.childNodes.length;i>n;n++)b(e.childNodes[n],t)}var w,E,$,T,x,S,C=[],P=C.slice,M=C.filter,O=window.document,A={},N={},I={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},L=/^\s*<(\w+|!)[^>]*>/,R=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,F=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,k=/^(?:body|html)$/i,j=/([A-Z])/g,D=["val","css","html","text","data","width","height","offset"],H=["after","prepend","before","append"],B=O.createElement("table"),z=O.createElement("tr"),W={tr:O.createElement("tbody"),tbody:B,thead:B,tfoot:B,td:z,th:z,"*":O.createElement("div")},U=/complete|loaded|interactive/,X=/^[\w-]*$/,Y={},G=Y.toString,V={},q=O.createElement("div"),J={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Z=Array.isArray||function(e){return e instanceof Array};return V.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var i,r=e.parentNode,s=!r;return s&&(r=q).appendChild(e),i=~V.qsa(r,t).indexOf(e),s&&q.removeChild(e),i},x=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},S=function(e){return M.call(e,function(t,n){return e.indexOf(t)==n})},V.fragment=function(e,t,n){var i,r,a;return R.test(e)&&(i=$(O.createElement(RegExp.$1))),i||(e.replace&&(e=e.replace(F,"<$1></$2>")),t===w&&(t=L.test(e)&&RegExp.$1),t in W||(t="*"),a=W[t],a.innerHTML=""+e,i=$.each(P.call(a.childNodes),function(){a.removeChild(this)})),s(n)&&(r=$(i),$.each(n,function(e,t){D.indexOf(e)>-1?r[e](t):r.attr(e,t)})),i},V.Z=function(e,t){return e=e||[],e.__proto__=$.fn,e.selector=t||"",e},V.isZ=function(e){return e instanceof V.Z},V.init=function(e,n){var i;if(!e)return V.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&L.test(e))i=V.fragment(e,RegExp.$1,n),e=null;else{if(n!==w)return $(n).find(e);i=V.qsa(O,e)}else{if(t(e))return $(O).ready(e);if(V.isZ(e))return e;if(Z(e))i=o(e);else if(r(e))i=[e],e=null;else if(L.test(e))i=V.fragment(e.trim(),RegExp.$1,n),e=null;else{if(n!==w)return $(n).find(e);i=V.qsa(O,e)}}return V.Z(i,e)},$=function(e,t){return V.init(e,t)},$.extend=function(e){var t,n=P.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){p(e,n,t)}),e},V.qsa=function(e,t){var n,r="#"==t[0],s=!r&&"."==t[0],a=r||s?t.slice(1):t,o=X.test(a);return i(e)&&o&&r?(n=e.getElementById(a))?[n]:[]:1!==e.nodeType&&9!==e.nodeType?[]:P.call(o&&!r?s?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},$.contains=O.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},$.type=e,$.isFunction=t,$.isWindow=n,$.isArray=Z,$.isPlainObject=s,$.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},$.inArray=function(e,t,n){return C.indexOf.call(t,e,n)},$.camelCase=x,$.trim=function(e){return null==e?"":String.prototype.trim.call(e)},$.uuid=0,$.support={},$.expr={},$.map=function(e,t){var n,i,r,s=[];if(a(e))for(i=0;i<e.length;i++)n=t(e[i],i),null!=n&&s.push(n);else for(r in e)n=t(e[r],r),null!=n&&s.push(n);return l(s)},$.each=function(e,t){var n,i;if(a(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(i in e)if(t.call(e[i],i,e[i])===!1)return e;return e},$.grep=function(e,t){return M.call(e,t)},window.JSON&&($.parseJSON=JSON.parse),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Y["[object "+t+"]"]=t.toLowerCase()}),$.fn={forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,indexOf:C.indexOf,concat:C.concat,map:function(e){return $($.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return $(P.apply(this,arguments))},ready:function(e){return U.test(O.readyState)&&O.body?e($):O.addEventListener("DOMContentLoaded",function(){e($)},!1),this},get:function(e){return e===w?P.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return C.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):$(M.call(this,function(t){return V.matches(t,e)}))},add:function(e,t){return $(S(this.concat($(e,t))))},is:function(e){return this.length>0&&V.matches(this[0],e)},not:function(e){var n=[];if(t(e)&&e.call!==w)this.each(function(t){e.call(this,t)||n.push(this)});else{var i="string"==typeof e?this.filter(e):a(e)&&t(e.item)?P.call(e):$(e);this.forEach(function(e){i.indexOf(e)<0&&n.push(e)})}return $(n)},has:function(e){return this.filter(function(){return r(e)?$.contains(this,e):$(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:$(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:$(e)},find:function(e){var t,n=this;return t=e?"object"==typeof e?$(e).filter(function(){var e=this;return C.some.call(n,function(t){return $.contains(t,e)})}):1==this.length?$(V.qsa(this[0],e)):this.map(function(){return V.qsa(this,e)}):$()},closest:function(e,t){var n=this[0],r=!1;for("object"==typeof e&&(r=$(e));n&&!(r?r.indexOf(n)>=0:V.matches(n,e));)n=n!==t&&!i(n)&&n.parentNode;return $(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=$.map(n,function(e){return(e=e.parentNode)&&!i(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return g(t,e)},parent:function(e){return g(S(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return d(this)}),e)},contents:function(){return this.map(function(){return P.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return M.call(d(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return $.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=f(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var n=t(e);if(this[0]&&!n)var i=$(e).get(0),r=i.parentNode||this.length>1;return this.each(function(t){$(this).wrapAll(n?e.call(this,t):r?i.cloneNode(!0):i)})},wrapAll:function(e){if(this[0]){$(this[0]).before(e=$(e));for(var t;(t=e.children()).length;)e=t.first();$(e).append(this)}return this},wrapInner:function(e){var n=t(e);return this.each(function(t){var i=$(this),r=i.contents(),s=n?e.call(this,t):e;r.length?r.wrapAll(s):i.append(s)})},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=$(this);(e===w?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return $(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return $(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var n=this.innerHTML;$(this).empty().append(m(this,e,t,n))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var n=m(this,e,t,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(e,t){var n;return"string"!=typeof e||1 in arguments?this.each(function(n){if(1===this.nodeType)if(r(e))for(E in e)v(this,E,e[E]);else v(this,e,m(this,t,n,this.getAttribute(e)))}):this.length&&1===this[0].nodeType?!(n=this[0].getAttribute(e))&&e in this[0]?this[0][e]:n:w},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){v(this,e)},this)})},prop:function(e,t){return e=J[e]||e,1 in arguments?this.each(function(n){this[e]=m(this,t,n,this[e])}):this[0]&&this[0][e]},data:function(e,t){var n="data-"+e.replace(j,"-$1").toLowerCase(),i=1 in arguments?this.attr(n,t):this.attr(n);return null!==i?y(i):w},val:function(e){return 0 in arguments?this.each(function(t){this.value=m(this,e,t,this.value)}):this[0]&&(this[0].multiple?$(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var n=$(this),i=m(this,e,t,n.offset()),r=n.offsetParent().offset(),s={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)});if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,n){if(arguments.length<2){var i,r=this[0];if(!r)return;
if(i=getComputedStyle(r,""),"string"==typeof t)return r.style[x(t)]||i.getPropertyValue(t);if(Z(t)){var s={};return $.each(t,function(e,t){s[t]=r.style[x(t)]||i.getPropertyValue(t)}),s}}var a="";if("string"==e(t))n||0===n?a=u(t)+":"+h(t,n):this.each(function(){this.style.removeProperty(u(t))});else for(E in t)t[E]||0===t[E]?a+=u(E)+":"+h(E,t[E])+";":this.each(function(){this.style.removeProperty(u(E))});return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf($(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return e?C.some.call(this,function(e){return this.test(_(e))},c(e)):!1},addClass:function(e){return e?this.each(function(t){if("className"in this){T=[];var n=_(this),i=m(this,e,t,n);i.split(/\s+/g).forEach(function(e){$(this).hasClass(e)||T.push(e)},this),T.length&&_(this,n+(n?" ":"")+T.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===w)return _(this,"");T=_(this),m(this,e,t,T).split(/\s+/g).forEach(function(e){T=T.replace(c(e)," ")}),_(this,T.trim())}})},toggleClass:function(e,t){return e?this.each(function(n){var i=$(this),r=m(this,e,n,_(this));r.split(/\s+/g).forEach(function(e){(t===w?!i.hasClass(e):t)?i.addClass(e):i.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===w?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===w?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),i=k.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat($(e).css("margin-top"))||0,n.left-=parseFloat($(e).css("margin-left"))||0,i.top+=parseFloat($(t[0]).css("border-top-width"))||0,i.left+=parseFloat($(t[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||O.body;e&&!k.test(e.nodeName)&&"static"==$(e).css("position");)e=e.offsetParent;return e})}},$.fn.detach=$.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});$.fn[e]=function(r){var s,a=this[0];return r===w?n(a)?a["inner"+t]:i(a)?a.documentElement["scroll"+t]:(s=this.offset())&&s[e]:this.each(function(t){a=$(this),a.css(e,m(this,r,t,a[e]()))})}}),H.forEach(function(t,n){var i=n%2;$.fn[t]=function(){var t,r,s=$.map(arguments,function(n){return t=e(n),"object"==t||"array"==t||null==n?n:V.fragment(n)}),a=this.length>1;return s.length<1?this:this.each(function(e,t){r=i?t:t.parentNode,t=0==n?t.nextSibling:1==n?t.firstChild:2==n?t:null;var o=$.contains(O.documentElement,r);s.forEach(function(e){if(a)e=e.cloneNode(!0);else if(!r)return $(e).remove();r.insertBefore(e,t),o&&b(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},$.fn[i?t+"To":"insert"+(n?"Before":"After")]=function(e){return $(e)[t](this),this}}),V.Z.prototype=$.fn,V.uniq=S,V.deserializeValue=y,$.zepto=V,$}();window.Zepto=n,void 0===window.$&&(window.$=n),function($){function e(e){return e._zid||(e._zid=h++)}function t(t,r,s,a){if(r=n(r),r.ns)var o=i(r.ns);return(g[e(t)]||[]).filter(function(t){return t&&(!r.e||t.e==r.e)&&(!r.ns||o.test(t.ns))&&(!s||e(t.fn)===e(s))&&(!a||t.sel==a)})}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function r(e,t){return e.del&&!v&&e.e in _||!!t}function s(e){return y[e]||v&&_[e]||e}function a(t,i,a,o,u,h,f){var d=e(t),p=g[d]||(g[d]=[]);i.split(/\s/).forEach(function(e){if("ready"==e)return $(document).ready(a);var i=n(e);i.fn=a,i.sel=u,i.e in y&&(a=function(e){var t=e.relatedTarget;return!t||t!==this&&!$.contains(this,t)?i.fn.apply(this,arguments):void 0}),i.del=h;var d=h||a;i.proxy=function(e){if(e=l(e),!e.isImmediatePropagationStopped()){e.data=o;var n=d.apply(t,e._args==c?[e]:[e].concat(e._args));return n===!1&&(e.preventDefault(),e.stopPropagation()),n}},i.i=p.length,p.push(i),"addEventListener"in t&&t.addEventListener(s(i.e),i.proxy,r(i,f))})}function o(n,i,a,o,l){var u=e(n);(i||"").split(/\s/).forEach(function(e){t(n,e,a,o).forEach(function(e){delete g[u][e.i],"removeEventListener"in n&&n.removeEventListener(s(e.e),e.proxy,r(e,l))})})}function l(e,t){return(t||!e.isDefaultPrevented)&&(t||(t=e),$.each(T,function(n,i){var r=t[n];e[n]=function(){return this[i]=b,r&&r.apply(t,arguments)},e[i]=w}),(t.defaultPrevented!==c?t.defaultPrevented:"returnValue"in t?t.returnValue===!1:t.getPreventDefault&&t.getPreventDefault())&&(e.isDefaultPrevented=b)),e}function u(e){var t,n={originalEvent:e};for(t in e)E.test(t)||e[t]===c||(n[t]=e[t]);return l(n,e)}var c,h=1,f=Array.prototype.slice,d=$.isFunction,p=function(e){return"string"==typeof e},g={},m={},v="onfocusin"in window,_={focus:"focusin",blur:"focusout"},y={mouseenter:"mouseover",mouseleave:"mouseout"};m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",$.event={add:a,remove:o},$.proxy=function(t,n){var i=2 in arguments&&f.call(arguments,2);if(d(t)){var r=function(){return t.apply(n,i?i.concat(f.call(arguments)):arguments)};return r._zid=e(t),r}if(p(n))return i?(i.unshift(t[n],t),$.proxy.apply(null,i)):$.proxy(t[n],t);throw new TypeError("expected function")},$.fn.bind=function(e,t,n){return this.on(e,t,n)},$.fn.unbind=function(e,t){return this.off(e,t)},$.fn.one=function(e,t,n,i){return this.on(e,t,n,i,1)};var b=function(){return!0},w=function(){return!1},E=/^([A-Z]|returnValue$|layer[XY]$)/,T={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};$.fn.delegate=function(e,t,n){return this.on(t,e,n)},$.fn.undelegate=function(e,t,n){return this.off(t,e,n)},$.fn.live=function(e,t){return $(document.body).delegate(this.selector,e,t),this},$.fn.die=function(e,t){return $(document.body).undelegate(this.selector,e,t),this},$.fn.on=function(e,t,n,i,r){var s,l,h=this;return e&&!p(e)?($.each(e,function(e,i){h.on(e,t,n,i,r)}),h):(p(t)||d(i)||i===!1||(i=n,n=t,t=c),(d(n)||n===!1)&&(i=n,n=c),i===!1&&(i=w),h.each(function(c,h){r&&(s=function(e){return o(h,e.type,i),i.apply(this,arguments)}),t&&(l=function(e){var n,r=$(e.target).closest(t,h).get(0);return r&&r!==h?(n=$.extend(u(e),{currentTarget:r,liveFired:h}),(s||i).apply(r,[n].concat(f.call(arguments,1)))):void 0}),a(h,e,i,n,t,l||s)}))},$.fn.off=function(e,t,n){var i=this;return e&&!p(e)?($.each(e,function(e,n){i.off(e,t,n)}),i):(p(t)||d(n)||n===!1||(n=t,t=c),n===!1&&(n=w),i.each(function(){o(this,e,n,t)}))},$.fn.trigger=function(e,t){return e=p(e)||$.isPlainObject(e)?$.Event(e):l(e),e._args=t,this.each(function(){e.type in _&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):$(this).triggerHandler(e,t)})},$.fn.triggerHandler=function(e,n){var i,r;return this.each(function(s,a){i=u(p(e)?$.Event(e):e),i._args=n,i.target=a,$.each(t(a,e.type||e),function(e,t){return r=t.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){$.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),$.Event=function(e,t){p(e)||(t=e,e=t.type);var n=document.createEvent(m[e]||"Events"),i=!0;if(t)for(var r in t)"bubbles"==r?i=!!t[r]:n[r]=t[r];return n.initEvent(e,i,!0),l(n)}}(n),function($){function e(e,t,n){var i=$.Event(t);return $(e).trigger(i,n),!i.isDefaultPrevented()}function t(t,n,i,r){return t.global?e(n||v,i,r):void 0}function n(e){e.global&&0===$.active++&&t(e,null,"ajaxStart")}function i(e){e.global&&!--$.active&&t(e,null,"ajaxStop")}function r(e,n){var i=n.context;return n.beforeSend.call(i,e,n)===!1||t(n,i,"ajaxBeforeSend",[e,n])===!1?!1:void t(n,i,"ajaxSend",[e,n])}function s(e,n,i,r){var s=i.context,a="success";i.success.call(s,e,a,n),r&&r.resolveWith(s,[e,a,n]),t(i,s,"ajaxSuccess",[n,i,e]),o(a,n,i)}function a(e,n,i,r,s){var a=r.context;r.error.call(a,i,n,e),s&&s.rejectWith(a,[i,n,e]),t(r,a,"ajaxError",[i,r,e||n]),o(n,i,r)}function o(e,n,r){var s=r.context;r.complete.call(s,n,e),t(r,s,"ajaxComplete",[n,r]),i(r)}function l(){}function u(e){return e&&(e=e.split(";",2)[0]),e&&(e==E?"html":e==w?"json":y.test(e)?"script":b.test(e)&&"xml")||"text"}function c(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function h(e){e.processData&&e.data&&"string"!=$.type(e.data)&&(e.data=$.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=c(e.url,e.data),e.data=void 0)}function f(e,t,n,i){return $.isFunction(t)&&(i=n,n=t,t=void 0),$.isFunction(n)||(i=n,n=void 0),{url:e,data:t,success:n,dataType:i}}function d(e,t,n,i){var r,s=$.isArray(t),a=$.isPlainObject(t);$.each(t,function(t,o){r=$.type(o),i&&(t=n?i:i+"["+(a||"object"==r||"array"==r?t:"")+"]"),!i&&s?e.add(o.name,o.value):"array"==r||!n&&"object"==r?d(e,o,n,t):e.add(t,o)})}var p,g,m=0,v=window.document,_=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,y=/^(?:text|application)\/javascript/i,b=/^(?:text|application)\/xml/i,w="application/json",E="text/html",T=/^\s*$/,x=v.createElement("a");x.href=window.location.href,$.active=0,$.ajaxJSONP=function(e,t){if(!("type"in e))return $.ajax(e);var n,i,o=e.jsonpCallback,l=($.isFunction(o)?o():o)||"jsonp"+ ++m,u=v.createElement("script"),c=window[l],h=function(e){$(u).triggerHandler("error",e||"abort")},f={abort:h};return t&&t.promise(f),$(u).on("load error",function(r,o){clearTimeout(i),$(u).off().remove(),"error"!=r.type&&n?s(n[0],f,e,t):a(null,o||"error",f,e,t),window[l]=c,n&&$.isFunction(c)&&c(n[0]),c=n=void 0}),r(f,e)===!1?(h("abort"),f):(window[l]=function(){n=arguments},u.src=e.url.replace(/\?(.+)=\?/,"?$1="+l),v.head.appendChild(u),e.timeout>0&&(i=setTimeout(function(){h("timeout")},e.timeout)),f)},$.ajaxSettings={type:"GET",beforeSend:l,success:l,error:l,complete:l,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:E,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},$.ajax=function(e){var t,i=$.extend({},e||{}),o=$.Deferred&&$.Deferred();for(p in $.ajaxSettings)void 0===i[p]&&(i[p]=$.ajaxSettings[p]);n(i),i.crossDomain||(t=v.createElement("a"),t.href=i.url,t.href=t.href,i.crossDomain=x.protocol+"//"+x.host!=t.protocol+"//"+t.host),i.url||(i.url=window.location.toString()),h(i);var f=i.dataType,d=/\?.+=\?/.test(i.url);if(d&&(f="jsonp"),i.cache!==!1&&(e&&e.cache===!0||"script"!=f&&"jsonp"!=f)||(i.url=c(i.url,"_="+Date.now())),"jsonp"==f)return d||(i.url=c(i.url,i.jsonp?i.jsonp+"=?":i.jsonp===!1?"":"callback=?")),$.ajaxJSONP(i,o);var m,_=i.accepts[f],y={},b=function(e,t){y[e.toLowerCase()]=[e,t]},w=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,E=i.xhr(),S=E.setRequestHeader;if(o&&o.promise(E),i.crossDomain||b("X-Requested-With","XMLHttpRequest"),b("Accept",_||"*/*"),(_=i.mimeType||_)&&(_.indexOf(",")>-1&&(_=_.split(",",2)[0]),E.overrideMimeType&&E.overrideMimeType(_)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&b("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(g in i.headers)b(g,i.headers[g]);if(E.setRequestHeader=b,E.onreadystatechange=function(){if(4==E.readyState){E.onreadystatechange=l,clearTimeout(m);var e,t=!1;if(E.status>=200&&E.status<300||304==E.status||0==E.status&&"file:"==w){f=f||u(i.mimeType||E.getResponseHeader("content-type")),e=E.responseText;try{"script"==f?(1,eval)(e):"xml"==f?e=E.responseXML:"json"==f&&(e=T.test(e)?null:$.parseJSON(e))}catch(n){t=n}t?a(t,"parsererror",E,i,o):s(e,E,i,o)}else a(E.statusText||null,E.status?"error":"abort",E,i,o)}},r(E,i)===!1)return E.abort(),a(null,"abort",E,i,o),E;if(i.xhrFields)for(g in i.xhrFields)E[g]=i.xhrFields[g];var C="async"in i?i.async:!0;E.open(i.type,i.url,C,i.username,i.password);for(g in y)S.apply(E,y[g]);return i.timeout>0&&(m=setTimeout(function(){E.onreadystatechange=l,E.abort(),a(null,"timeout",E,i,o)},i.timeout)),E.send(i.data?i.data:null),E},$.get=function(){return $.ajax(f.apply(null,arguments))},$.post=function(){var e=f.apply(null,arguments);return e.type="POST",$.ajax(e)},$.getJSON=function(){var e=f.apply(null,arguments);return e.dataType="json",$.ajax(e)},$.fn.load=function(e,t,n){if(!this.length)return this;var i,r=this,s=e.split(/\s/),a=f(e,t,n),o=a.success;return s.length>1&&(a.url=s[0],i=s[1]),a.success=function(e){r.html(i?$("<div>").html(e.replace(_,"")).find(i):e),o&&o.apply(r,arguments)},$.ajax(a),this};var S=encodeURIComponent;$.param=function(e,t){var n=[];return n.add=function(e,t){$.isFunction(t)&&(t=t()),null==t&&(t=""),this.push(S(e)+"="+S(t))},d(n,e,t),n.join("&").replace(/%20/g,"+")}}(n),function($){$.fn.serializeArray=function(){var e,t,n=[],i=function(t){return t.forEach?t.forEach(i):void n.push({name:e,value:t})};return this[0]&&$.each(this[0].elements,function(n,r){t=r.type,e=r.name,e&&"fieldset"!=r.nodeName.toLowerCase()&&!r.disabled&&"submit"!=t&&"reset"!=t&&"button"!=t&&"file"!=t&&("radio"!=t&&"checkbox"!=t||r.checked)&&i($(r).val())}),n},$.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},$.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var t=$.Event("submit");this.eq(0).trigger(t),t.isDefaultPrevented()||this.get(0).submit()}return this}}(n),function($){"__proto__"in{}||$.extend($.zepto,{Z:function(e,t){return e=e||[],$.extend(e,$.fn),e.selector=t||"",e.__Z=!0,e},isZ:function(e){return"array"===$.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e){try{return t(e)}catch(n){return null}}}}(n),e.exports=n},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this[0],t=r.call(this);return e.offsetHeight+t}function r(){var e=s.call(this);return e.top+e.bottom}function s(){var e,t=this[0],n=window.getComputedStyle(t,null);return e={top:l(n,"margin-top"),right:l(n,"margin-right"),bottom:l(n,"margin-bottom"),left:l(n,"margin-left")},e.height=e.top+e.bottom,e.width=e.left+e.right,e}function a(){var e=this[0],t=window.getComputedStyle(e,null);return{top:l(t,"padding-top"),right:l(t,"padding-right"),bottom:l(t,"padding-bottom"),left:l(t,"padding-left")}}function o(){var e=this[0],t=e.getBoundingClientRect(),n=s.call(this),i=a.call(this);return{height:e.clientHeight,width:e.clientWidth,top:t.top,right:t.right,bottom:t.bottom,left:t.left,outerHeight:t.height+n.height,outerWidth:t.width+n.width,marginTop:n.top,marginRight:n.right,marginBottom:n.bottom,marginLeft:n.left,marginHeight:n.height,marginWidth:n.width,paddingTop:i.top,paddingRight:i.right,paddingBottom:i.bottom,paddingLeft:i.left,lineHeight:parseInt(c["default"].fn.css.call(this,"line-height"),10)}}function l(e,t){return parseInt(e.getPropertyValue(t),10)}var u=t(5),c=n(u);"undefined"!=typeof window&&(c["default"].fn.outerHeight=i,c["default"].fn.marginHeight=r,c["default"].fn.margin=s,c["default"].fn.padding=a,c["default"].fn.metrics=o)},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}/*!
	   * textFit.js
	   *
	   * Copyright 2011, Peter Rudolfsen
	   */
function i(e){return this.each(function(){var e=(0,s["default"])(this),t=t||1,n=(0,s["default"])('<span style="display:inline-block;margin:0;padding:0;"></span>').html(e.text()),i=parseInt(window.getComputedStyle(this).getPropertyValue("font-size"),10),r=e.width(),a=0;if(0!==r){for(e.empty().append(n),a=n.width(),a>=r&&(i=8,e.css("font-size",i+"px"),a=n.width());r>a;)i+=1,e.css("font-size",i+"px"),a=n.width(),r=e.width();a>=r&&(i-=1),e.css("font-size",i/t+"px")}})}var r=t(5),s=n(r);"undefined"!=typeof window&&(s["default"].fn.textFit=i)},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(10),a=n(s);exports["default"]=r["default"].extend({},a["default"].Events)},function(e,exports,t){var n,i;(function(r){!function(s){var a="object"==typeof self&&self.self==self&&self||"object"==typeof r&&r.global==r&&r;n=[t(1),t(6),exports],i=function(e,$,exports){a.Backbone=s(a,exports,e,$)}.apply(exports,n),!(void 0!==i&&(e.exports=i))}(function(e,t,n,$){var i=e.Backbone,r=Array.prototype.slice;t.VERSION="1.2.3",t.$=$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,i){switch(e){case 1:return function(){return n[t](this[i])};case 2:return function(e){return n[t](this[i],e)};case 3:return function(e,r){return n[t](this[i],o(e,this),r)};case 4:return function(e,r,s){return n[t](this[i],o(e,this),r,s)};default:return function(){var e=r.call(arguments);return e.unshift(this[i]),n[t].apply(n,e)}}},a=function(e,t,i){n.each(t,function(t,r){n[r]&&(e.prototype[r]=s(t,r,i))})},o=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?l(e):n.isString(e)?function(t){return t.get(e)}:e},l=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},u=t.Events={},c=/\s+/,h=function(e,t,i,r,s){var a,o=0;if(i&&"object"==typeof i){void 0!==r&&"context"in s&&void 0===s.context&&(s.context=r);for(a=n.keys(i);o<a.length;o++)t=h(e,t,a[o],i[a[o]],s)}else if(i&&c.test(i))for(a=i.split(c);o<a.length;o++)t=e(t,a[o],r,s);else t=e(t,i,r,s);return t};u.on=function(e,t,n){return f(this,e,t,n)};var f=function(e,t,n,i,r){if(e._events=h(d,e._events||{},t,n,{context:i,ctx:e,listening:r}),r){var s=e._listeners||(e._listeners={});s[r.id]=r}return e};u.listenTo=function(e,t,i){if(!e)return this;var r=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),a=s[r];if(!a){var o=this._listenId||(this._listenId=n.uniqueId("l"));a=s[r]={obj:e,objId:r,id:o,listeningTo:s,count:0}}return f(e,t,i,this,a),this};var d=function(e,t,n,i){if(n){var r=e[t]||(e[t]=[]),s=i.context,a=i.ctx,o=i.listening;o&&o.count++,r.push({callback:n,context:s,ctx:s||a,listening:o})}return e};u.off=function(e,t,n){return this._events?(this._events=h(p,this._events,e,t,{context:n,listeners:this._listeners}),this):this},u.stopListening=function(e,t,i){var r=this._listeningTo;if(!r)return this;for(var s=e?[e._listenId]:n.keys(r),a=0;a<s.length;a++){var o=r[s[a]];if(!o)break;o.obj.off(t,i,this)}return n.isEmpty(r)&&(this._listeningTo=void 0),this};var p=function(e,t,i,r){if(e){var s,a=0,o=r.context,l=r.listeners;if(t||i||o){for(var u=t?[t]:n.keys(e);a<u.length;a++){t=u[a];var c=e[t];if(!c)break;for(var h=[],f=0;f<c.length;f++){var d=c[f];i&&i!==d.callback&&i!==d.callback._callback||o&&o!==d.context?h.push(d):(s=d.listening,s&&0===--s.count&&(delete l[s.id],delete s.listeningTo[s.objId]))}h.length?e[t]=h:delete e[t]}return n.size(e)?e:void 0}for(var p=n.keys(l);a<p.length;a++)s=l[p[a]],delete l[s.id],delete s.listeningTo[s.objId]}};u.once=function(e,t,i){var r=h(g,{},e,t,n.bind(this.off,this));return this.on(r,void 0,i)},u.listenToOnce=function(e,t,i){var r=h(g,{},t,i,n.bind(this.stopListening,this,e));return this.listenTo(e,r)};var g=function(e,t,i,r){if(i){var s=e[t]=n.once(function(){r(t,s),i.apply(this,arguments)});s._callback=i}return e};u.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),i=0;t>i;i++)n[i]=arguments[i+1];return h(m,this._events,e,void 0,n),this};var m=function(e,t,n,i){if(e){var r=e[t],s=e.all;r&&s&&(s=s.slice()),r&&v(r,i),s&&v(s,[t].concat(i))}return e},v=function(e,t){var n,i=-1,r=e.length,s=t[0],a=t[1],o=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,a);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,a,o);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t);return}};u.bind=u.on,u.unbind=u.off,n.extend(t,u);var _=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(_.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var r;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;var s=i.unset,a=i.silent,o=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,h=this._previousAttributes;for(var f in r)t=r[f],n.isEqual(u[f],t)||o.push(f),n.isEqual(h[f],t)?delete c[f]:c[f]=t,s?delete u[f]:u[f]=t;if(this.id=this.get(this.idAttribute),!a){o.length&&(this._pending=i);for(var d=0;d<o.length;d++)this.trigger("change:"+o[d],this,u[o[d]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,i={};for(var r in e){var s=e[r];n.isEqual(t[r],s)||(i[r]=s)}return n.size(i)?i:!1},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(n){var r=e.parse?t.parse(n,e):n;return t.set(r,e)?(i&&i.call(e.context,t,n,e),void t.trigger("sync",t,n,e)):!1},B(this,e),this.sync("read",this,e)},save:function(e,t,i){var r;null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0,parse:!0},i);var s=i.wait;if(r&&!s){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var a=this,o=i.success,l=this.attributes;i.success=function(e){a.attributes=l;var t=i.parse?a.parse(e,i):e;return s&&(t=n.extend({},r,t)),t&&!a.set(t,i)?!1:(o&&o.call(i.context,a,e,i),void a.trigger("sync",a,e,i))},B(this,i),r&&s&&(this.attributes=n.extend({},l,r));var u=this.isNew()?"create":i.patch?"patch":"update";"patch"!==u||i.attrs||(i.attrs=r);var c=this.sync(u,this,i);return this.attributes=l,c},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){r&&s(),i&&i.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var a=!1;return this.isNew()?n.defer(e.success):(B(this,e),a=this.sync("delete",this,e)),r||s(),a},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||H();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var y={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(_,y,"attributes");var b=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},w={add:!0,remove:!0,merge:!0},E={add:!0,remove:!1},T=function(e,t,n){n=Math.min(Math.max(n,0),e.length);for(var i=Array(e.length-n),r=t.length,s=0;s<i.length;s++)i[s]=e[s+n];for(s=0;r>s;s++)e[s+n]=t[s];for(s=0;s<i.length;s++)e[s+r+n]=i[s]};n.extend(b.prototype,u,{model:_,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,E))},remove:function(e,t){t=n.extend({},t);var i=!n.isArray(e);e=i?[e]:n.clone(e);var r=this._removeModels(e,t);return!t.silent&&r&&this.trigger("update",this,t),i?r[0]:r},set:function(e,t){if(null!=e){t=n.defaults({},t,w),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?[e]:e.slice();var r=t.at;null!=r&&(r=+r),0>r&&(r+=this.length+1);for(var s,a=[],o=[],l=[],u={},c=t.add,h=t.merge,f=t.remove,d=!1,p=this.comparator&&null==r&&t.sort!==!1,g=n.isString(this.comparator)?this.comparator:null,m=0;m<e.length;m++){s=e[m];var v=this.get(s);if(v){if(h&&s!==v){var _=this._isModel(s)?s.attributes:s;t.parse&&(_=v.parse(_,t)),v.set(_,t),p&&!d&&(d=v.hasChanged(g))}u[v.cid]||(u[v.cid]=!0,a.push(v)),e[m]=v}else c&&(s=e[m]=this._prepareModel(s,t),s&&(o.push(s),this._addReference(s,t),u[s.cid]=!0,a.push(s)))}if(f){for(m=0;m<this.length;m++)s=this.models[m],u[s.cid]||l.push(s);l.length&&this._removeModels(l,t)}var y=!1,b=!p&&c&&f;if(a.length&&b?(y=this.length!=a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,T(this.models,a,0),this.length=this.models.length):o.length&&(p&&(d=!0),T(this.models,o,null==r?this.length:r),this.length=this.models.length),d&&this.sort({silent:!0}),!t.silent){for(m=0;m<o.length;m++)null!=r&&(t.index=r+m),s=o[m],s.trigger("add",s,this,t);(d||y)&&this.trigger("sort",this,t),(o.length||l.length)&&this.trigger("update",this,t)}return i?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return r.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),1===i||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t.call(e.context,i,n,e),i.trigger("sync",i,n,e)},B(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var i=t.wait;if(e=this._prepareModel(e,t),!e)return!1;i||this.add(e,t);var r=this,s=t.success;return t.success=function(e,t,n){i&&r.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=this.get(e[i]);if(r){var s=this.indexOf(r);this.models.splice(s,1),this.length--,t.silent||(t.index=s,r.trigger("remove",r,this,t)),n.push(r),this._removeReference(r,t)}}return n.length?n:!1},_isModel:function(e){return e instanceof _},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){if("add"!==e&&"remove"!==e||n===this){if("destroy"===e&&this.remove(t,i),"change"===e){var r=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);r!==s&&(null!=r&&delete this._byId[r],null!=s&&(this._byId[s]=t))}this.trigger.apply(this,arguments)}}});var x={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};a(b,x,"models");var S=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,P)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,P=["model","collection","el","id","attributes","className","tagName","events"];n.extend(S.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[i]),i){var r=t.match(C);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,r){var s=M[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:s,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||H()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){a.type="POST",r.emulateJSON&&(a.data._method=s);var o=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),o?o.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1);var l=r.error;r.error=function(e,t,n){r.textStatus=t,r.errorThrown=n,l&&l.call(r.context,e,t,n)};var u=r.xhr=t.ajax(n.extend(a,r));return i.trigger("request",i,u,r),u};var M={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,N=/(\(\?)?:\w+/g,I=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(O.prototype,u,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var s=this;return t.history.route(e,function(n){var a=s._extractParameters(e,n);s.execute(r,a,i)!==!1&&(s.trigger.apply(s,["route:"+i].concat(a)),s.trigger("route",i,a),t.history.trigger("route",s,i,a))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(A,"(?:$1)?").replace(N,function(e,t){return t?e:"([^/?]+)"}).replace(I,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var R=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,k=/^\/+|\/+$/g,j=/#.*$/;R.started=!1,n.extend(R.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(F,"")},start:function(e){if(R.started)throw new Error("Backbone.history has already been started");if(R.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(k,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};return this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),R.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})):!1},navigate:function(e,t){if(!R.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;(""===e||"?"===e.charAt(0))&&(n=n.slice(0,-1)||"/");var i=n+e;if(e=this.decodeFragment(e.replace(j,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new R;var D=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};_.extend=b.extend=O.extend=S.extend=R.extend=D;var H=function(){throw new Error('A "url" property or function must be specified')},B=function(e,t){var n=t.error;t.error=function(i){n&&n.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t})}).call(exports,function(){return this}())},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(10),r=n(i),s=function(){this.initialize.apply(this,arguments)};s.prototype={initialize:function(){}},s.extend=r["default"].Model.extend,exports["default"]=s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(10),r=n(i),s=t(13),a=n(s),o=t(14),l=n(o);exports["default"]=r["default"].View.extend({startX:0,startY:0,startScale:1,rotation:0,getSignature:function(){return this.signature||this.lockSignature(),this.signature},lockSignature:function(){this.signature=(0,l["default"])(this.el.outerHTML),this.innerSignature=(0,l["default"])(this.el.innerHTML)},matchesSignature:function(e){return e===this.signature},matchesInnerSignature:function(e){return e===this.innerSignature},matchesAnySignature:function(e){return this.matchesSignature(e)||this.matchesInnerSignature(e)},disable:function(){this.isDisabled=!0,this.$el.addClass(a["default"].IS_DISABLED)},enable:function(){this.isDisabled=!1,this.$el.removeClass(a["default"].IS_DISABLED)},isInDOM:function(){return null!==this.el.parentNode},startTransform:function(e){e.preventDefault(),e.stopPropagation(),this.startX=e.pageX,this.startY=e.pageY,this.startScale=e.scale,this.startRotation=e.rotation,e.currentTarget.classList.add("alf-is-moving")},transformEventTarget:function(e){this.transformElByEvent(e.currentTarget,e)},transformEl:function(e){this.transformElByEvent(this.el,e)},transformElByEvent:function(e,t){t.preventDefault(),t.stopPropagation(),t=t.originalEvent||t;var n=t.pageX-this.startX,i=t.pageY-this.startY,r=t.scale,s=t.rotation-this.startRotation;this.doTransform(e,{x:n,y:i,scale:r,rotation:s})},doTransform:function(e,t){var n="";n+="translate3d("+t.x+"px, "+t.y+"px, 1px)",t.rotation&&(n+="rotate("+t.rotation+"deg) "),n+="scale("+t.scale+") ",e.style.webkitTransition="none",e.style.webkitTransform=n},enableScrolling:function(e){e=e||{x:!0,y:!0};var t=[];e.x&&t.push("alf-is-scrollable-x"),e.y&&t.push("alf-is-scrollable-y"),this.$el.addClass(t.join(" "))},preventDefault:function(e){e.preventDefault()}})},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={ALLOW_MULTIPLE:"alf-allow-multiple",ALLOW_OVERFLOW:"alf-allow-overflow",ASSET_STYLESHEET:"alf-asset-stylesheet",BREAK_BEFORE:"alf-break-before",BTN_GROUP:"alf-btn-group",CONTAINER:"alf-container",CONTAINER_FULLSCREEN:"alf-container-fullscreen",CONTAINER_INLINE:"alf-container-inline",CONTAINER_IS_UNLOADED:"alf-container-is-unloaded",CONTROLS_OFF:"alf-controls-off",FULLSCREEN_CONTENT:"alf-fullscreen-content",FULLSCREEN_EXIT:"alf-fullscreen-exit",FULLSCREEN_TOOLBAR:"alf-fullscreen-toolbar",MULTI_CHOICE:"alf-multiple-choices",IMAGE:"alf-image",IS_BREAKABLE:"alf-is-breakable",IS_DISABLED:"alf-is-disabled",IS_DRAGGABLE:"alf-is-draggable",IS_DRAGGABLE_X:"alf-is-draggable-x",IS_DRAGGABLE_Y:"alf-is-draggable-y",IS_EDITABLE:"alf-is-editable",IS_HIDDEN:"alf-is-hidden",IS_FIRST_BLOCK:"alf-block-is-first",IS_LAST_BLOCK:"alf-block-is-last",IS_NON_BREAKABLE:"alf-is-non-breakable",IS_NON_REARRANGEABLE:"alf-is-non-rearrangeable",IS_NON_SPLITTABLE:"alf-is-non-splittable",IS_OPTIONAL:"alf-is-optional",IS_PLAYING:"alf-is-playing",IS_REARRANGEABLE:"alf-is-rearrangeable",IS_REMOVABLE:"alf-is-removable",IS_REMOVED:"alf-is-removed",IS_RESPONSIVE:"alf-is-responsive",IS_RESIZABLE:"alf-is-resizable",IS_SPLITTABLE:"alf-is-splittable",IS_VISIBLE:"alf-is-visible",NO_SCORE:"alf-no-score",PAGENUM_X:function(e){return"alf-pagenum-"+e},PAGENUM_TOTAL_X:function(e){return"alf-pagenum-total-"+e},REVISION:function(e){return"alf-rev-"+e},REGION:"alf-region",REGION_FLEXIBLE:"alf-region-flexible",SIZE_DETECTOR:"alf-size-detector",STICK_TO_NEXT:"alf-stick-to-next",STRETCH_TO_FIT:"alf-stretch-to-fit",SUPPORTS_FULLSCREEN:"alf-supports-fullscreen",WIDGET:"alf-widget"}},function(e,exports){"use strict";function t(e,t){var n=e[0],o=e[1],l=e[2],u=e[3];n=i(n,o,l,u,t[0],7,-680876936),u=i(u,n,o,l,t[1],12,-389564586),l=i(l,u,n,o,t[2],17,606105819),o=i(o,l,u,n,t[3],22,-1044525330),n=i(n,o,l,u,t[4],7,-176418897),u=i(u,n,o,l,t[5],12,1200080426),l=i(l,u,n,o,t[6],17,-1473231341),o=i(o,l,u,n,t[7],22,-45705983),n=i(n,o,l,u,t[8],7,1770035416),u=i(u,n,o,l,t[9],12,-1958414417),l=i(l,u,n,o,t[10],17,-42063),o=i(o,l,u,n,t[11],22,-1990404162),n=i(n,o,l,u,t[12],7,1804603682),u=i(u,n,o,l,t[13],12,-40341101),l=i(l,u,n,o,t[14],17,-1502002290),o=i(o,l,u,n,t[15],22,1236535329),n=r(n,o,l,u,t[1],5,-165796510),u=r(u,n,o,l,t[6],9,-1069501632),l=r(l,u,n,o,t[11],14,643717713),o=r(o,l,u,n,t[0],20,-373897302),n=r(n,o,l,u,t[5],5,-701558691),u=r(u,n,o,l,t[10],9,38016083),l=r(l,u,n,o,t[15],14,-660478335),o=r(o,l,u,n,t[4],20,-405537848),n=r(n,o,l,u,t[9],5,568446438),u=r(u,n,o,l,t[14],9,-1019803690),l=r(l,u,n,o,t[3],14,-187363961),o=r(o,l,u,n,t[8],20,1163531501),n=r(n,o,l,u,t[13],5,-1444681467),u=r(u,n,o,l,t[2],9,-51403784),l=r(l,u,n,o,t[7],14,1735328473),o=r(o,l,u,n,t[12],20,-1926607734),n=s(n,o,l,u,t[5],4,-378558),u=s(u,n,o,l,t[8],11,-2022574463),l=s(l,u,n,o,t[11],16,1839030562),o=s(o,l,u,n,t[14],23,-35309556),n=s(n,o,l,u,t[1],4,-1530992060),u=s(u,n,o,l,t[4],11,1272893353),l=s(l,u,n,o,t[7],16,-155497632),o=s(o,l,u,n,t[10],23,-1094730640),n=s(n,o,l,u,t[13],4,681279174),u=s(u,n,o,l,t[0],11,-358537222),l=s(l,u,n,o,t[3],16,-722521979),o=s(o,l,u,n,t[6],23,76029189),n=s(n,o,l,u,t[9],4,-640364487),u=s(u,n,o,l,t[12],11,-421815835),l=s(l,u,n,o,t[15],16,530742520),o=s(o,l,u,n,t[2],23,-995338651),n=a(n,o,l,u,t[0],6,-198630844),u=a(u,n,o,l,t[7],10,1126891415),l=a(l,u,n,o,t[14],15,-1416354905),o=a(o,l,u,n,t[5],21,-57434055),n=a(n,o,l,u,t[12],6,1700485571),u=a(u,n,o,l,t[3],10,-1894986606),l=a(l,u,n,o,t[10],15,-1051523),o=a(o,l,u,n,t[1],21,-2054922799),n=a(n,o,l,u,t[8],6,1873313359),u=a(u,n,o,l,t[15],10,-30611744),l=a(l,u,n,o,t[6],15,-1560198380),o=a(o,l,u,n,t[13],21,1309151649),n=a(n,o,l,u,t[4],6,-145523070),u=a(u,n,o,l,t[11],10,-1120210379),l=a(l,u,n,o,t[2],15,718787259),o=a(o,l,u,n,t[9],21,-343485551),e[0]=f(n,e[0]),e[1]=f(o,e[1]),e[2]=f(l,e[2]),e[3]=f(u,e[3])}function n(e,t,n,i,r,s){return t=f(f(t,e),f(i,s)),f(t<<r|t>>>32-r,n)}function i(e,t,i,r,s,a,o){return n(t&i|~t&r,e,t,s,a,o)}function r(e,t,i,r,s,a,o){return n(t&r|i&~r,e,t,s,a,o)}function s(e,t,i,r,s,a,o){return n(t^i^r,e,t,s,a,o)}function a(e,t,i,r,s,a,o){return n(i^(t|~r),e,t,s,a,o)}function o(e){var n,i=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)t(r,l(e.substring(n-64,n)));e=e.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)s[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(s[n>>2]|=128<<(n%4<<3),n>55)for(t(r,s),n=0;16>n;n++)s[n]=0;return s[14]=8*i,t(r,s),r}function l(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function u(e){for(var t="",n=0;4>n;n++)t+=d[e>>8*n+4&15]+d[e>>8*n&15];return t}function c(e){for(var t=0;t<e.length;t++)e[t]=u(e[t]);return e.join("")}function h(e){return c(o(e))}function f(e,t){return e+t&4294967295}Object.defineProperty(exports,"__esModule",{value:!0});var d="0123456789abcdef".split("");exports["default"]=h},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(16),r=n(i),s=t(17),a=n(s),o=t(18),l=n(o),u=t(19),c=n(u),h=t(20),f=n(h);exports["default"]={Dispatcher:r["default"],Appear:a["default"],Clip:l["default"],Fade:c["default"],Scale:f["default"]}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(11),r=n(i),s=t(10),a=n(s),o=t(1),l=n(o),u=t(3),c=n(u),h=Math,f=r["default"].extend();l["default"].extend(f.prototype,a["default"].Events,{initialize:function(e){e=this.options=l["default"].extend({},e||{}),l["default"].bindAll(this,"stopRunning"),this.isReset=!1,this._isRunning=!1,this._isReversible=!1,e.target&&this.setTarget(e.target),e.to&&this.setTo(e.to)},setTarget:function(e){this.target=l["default"].defaults(e,{el:null,width:null,height:null,top:null,left:null}),this.calcMetrics()},setTargetEl:function(e){this.setTarget({el:e})},setTo:function(e){this.to=l["default"].defaults(e,{el:null,width:null,height:null})},isRunning:function(){return this._isRunning},stopRunning:function(){this._isRunning=!1},calcMetrics:function(){var e,t;e=this.target,t=this.to,e=l["default"].extend(e,e.el.getBoundingClientRect()),t=l["default"].extend(t,{width:t.el.clientWidth,height:t.el.clientHeight}),t.scaleX=e.width/t.width,t.scaleY=e.height/t.height,t.scale=h.max(t.scaleX,t.scaleY),e.scaleX=t.width/e.width,e.scaleY=t.height/e.height,e.scale=h.min(e.scaleX,e.scaleY),this.offsetX=h.round(e.left+(e.width-t.width)/2),this.offsetY=h.round(e.top+(e.height-t.height)/2),t.maskHeight=h.round(e.height/t.scale),t.maskWidth=h.round(e.width/t.scale),t.clipHeight=t.height-t.maskHeight,t.clipWidth=t.width-t.maskWidth},reset:function(){
var e=this.to,t=this.options.effect.animateFromProps.call(this);e.el.style.webkitTransitionDuration="0ms",e.el.style.mozTransitionDuration="0ms",e.el.style.msTransitionDuration="0ms",e.el.style.oTransitionDuration="0ms",e.el.style.transitionDuration="0ms";for(var n in t)-1===n.toLowerCase().indexOf("transition")&&(e.el.style[n]=t[n])},run:function(e){if(this._isRunning)return!1;this._isRunning=!0,this._isReversible=!0;var t=this,n=this.target,i=this.to,r=function(){t._animate(e)};if(!this.options.upscaleTarget||!n||!n.el)return void this.trigger("willAppear",this,r);n.el.classList.add("alf-is-moving");var s="",a=i.width/2-n.width/2-n.left,o=i.height/2-n.height/2-n.top;s+="translate3d("+a+"px, "+o+"px, 1px) ",s+="scale("+n.scale+") ",(0,c["default"])(n.el).one("webkitTransitionEnd",l["default"].bind(this._onScaleEnd,this,e)),(0,c["default"])(n.el).one("transitionend",l["default"].bind(this._onScaleEnd,this,e)),n.el.style.webkitTransition="-webkit-transform ease-out 300ms",n.el.style.transition="transform ease-out 300ms",n.el.style.webkitTransform=s,n.el.style.transform=s},reverse:function(e){var t=this.options.effect;if(this._isRunning||!this._isReversible)return!1;this._isRunning=!0;var n=this.to,i=(t.reverseProps||t.animateFromProps).call(this);(0,c["default"])(n.el).one("webkitTransitionEnd",l["default"].bind(this._onReverseEnd,this,e)),(0,c["default"])(n.el).one("transitionend",l["default"].bind(this._onReverseEnd,this,e));for(var r in i)n.el.style[r]=i[r]},reverseTo:function(e,t){this.to={el:e},this.calcMetrics(),this.reverse(t)},_animate:function(e){var t=this.to,n=this.options.effect.animateToProps.call(this);this.reset(),this.trigger("ready",this),(0,c["default"])(t.el).one("webkitTransitionEnd",l["default"].bind(this._onAnimateEnd,this,e)),(0,c["default"])(t.el).one("transitionend",l["default"].bind(this._onAnimateEnd,this,e)),l["default"].each(n,function(e,n){t.el.style[n]=e})},_onAnimateEnd:function(e){var t;this.to&&this.to.el&&(this.to.el.style.removeProperty("-webkit-transition"),this.to.el.style.removeProperty("transition")),this.target&&this.target.el&&(t=this.target.el.style,t.removeProperty("-webkit-transform"),t.removeProperty("-webkit-transition"),t.removeProperty("transform"),t.removeProperty("transition"),(0,c["default"])(this.target.el).removeClass("alf-is-moving")),e&&e.call(this,this),this.trigger("didAppear",this),setTimeout(this.stopRunning,100)},_onReverseEnd:function(e){this._isReversible=!1,this.to.el.style.webkitTransition="none",this.to.el.style.webkitTransform="none",this.to.el.style.mozTransition="none",this.to.el.style.mozTransform="none",this.to.el.style.msTransition="none",this.to.el.style.msTransform="none",this.to.el.style.oTransition="none",this.to.el.style.oTransform="none",this.to.el.style.transition="none",this.to.el.style.transform="none",e&&e.call(this,this),this.trigger("didDisappear",this),setTimeout(this.stopRunning,100)},_onScaleEnd:function(e){var t=this,n=function(){t._animate(e)};this.trigger("willAppear",this,n)}}),exports["default"]=f},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={reverseProps:function(){return{webkitTransition:"-webkit-transform ease-out 300ms",webkitTransform:"translate3d(-1500px, -1500px, 0) scale(0.4)"}},animateFromProps:function(){var e="";return e+="scaleX(0.8) scaleY(0.8) ",{webkitTransition:"-webkit-transform ease-out 300ms, opacity ease-out 300ms",webkitTransform:e,opacity:0}},animateToProps:function(){return{webkitTransition:"-webkit-transform ease-out 300ms, opacity ease-out 300ms",webkitTransform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",opacity:1}}};exports["default"]=t},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=Math;exports["default"]={animateFromProps:function(){var e="",n=this.to,i=t.round(this.clipHeight/2),r=n.height-i,s=t.round(this.clipWidth/2),a=n.width-s;return e+="translate3d("+this.offsetX+"px, "+this.offsetY+"px, 0px) ",e+="scale("+this.to.scale+") ",{webkitTransition:"-webkit-transform ease-out 300ms, clip ease-out 300ms",webkitTransform:e,clip:"rect("+i+"px, "+a+"px, "+r+"px, "+s+"px) "}},animateToProps:function(){var e=this.to;return{webkitTransition:"-webkit-transform ease-out 300ms, clip ease-out 300ms",webkitTransform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",clip:"rect(0px, "+e.width+"px, "+e.height+"px, 0px)"}}}},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={animateFromProps:function(){return{webkitTransition:"opacity ease-out 300ms",mozTransition:"opacity ease-out 300ms",msTransition:"opacity ease-out 300ms",oTransition:"opacity ease-out 300ms",transition:"opacity ease-out 300ms",opacity:0}},animateToProps:function(){return{webkitTransition:"opacity ease-out 300ms",mozTransition:"opacity ease-out 300ms",msTransition:"opacity ease-out 300ms",oTransition:"opacity ease-out 300ms",transition:"opacity ease-out 300ms",opacity:1}}};exports["default"]=t},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={animateFromProps:function(){var e="";return e+="translate3d("+this.offsetX+"px, "+this.offsetY+"px, 0px) ",e+="scaleX("+this.scaleX+") scaleY("+this.scaleY+") ",{webkitTransition:"-webkit-transform ease-out 300ms, opacity ease-out 200ms",webkitTransform:e,opacity:0}},animateToProps:function(){return{webkitTransition:"-webkit-transform ease-out 300ms, opacity ease-out 200ms",webkitTransform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",opacity:1}}};exports["default"]=t},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(22),r=n(i),s=t(23),a=n(s),o=t(24),l=n(o),u=t(25),c=n(u);exports["default"]={Manager:r["default"],View:a["default"],Page:l["default"],Fullscreen:c["default"]}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(11),r=n(i);exports["default"]=r["default"].extend({initialize:function(){this.layers=[],this.length=0},add:function(e){return this.layers.push(e),this.length=this.layers.length,this},remove:function(e){var t=this.layers;return t.splice(t.indexOf(e),1),this.length=this.layers.length,this},at:function(e){return this.layers[e]},getPos:function(e){return this.layers.indexOf(e)},getLayerAbove:function(e){return this.at(this.getPos(e)+1)},getLayerBelow:function(e){return this.at(this.getPos(e)-1)}})},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(12),a=n(s),o=t(15),l=n(o),u=t(13),c=n(u),h=a["default"].extend();r["default"].extend(h.prototype,{initialize:function(e){e&&e.manager&&(this.manager=e.manager,this.manager.add(this))},tearDown:function(){this.stopListening()},show:function(){return this.$el.removeClass(c["default"].IS_HIDDEN),this},hide:function(){return this.$el.addClass(c["default"].IS_HIDDEN),this},above:function(){return this.manager.getLayerAbove(this)},below:function(){return this.manager.getLayerBelow(this)},minimize:function(){var e=this,t=this.below();return t.show(),t.transition.reverse(function(){e.hide()}),this},transitionTo:function(e,t,n){return this._createTransition({layer:e,target:n,effect:t,upscaleTarget:!1})},scaleTo:function(e,t,n){return this._createTransition({layer:e,target:n,effect:t,upscaleTarget:!0})},transitionToLayerAbove:function(e,t){return this.transitionTo(this.above(),e,t)},transitionToLayerBelow:function(e,t){return this.transitionTo(this.below(),t,e)},_createTransition:function(e){e.to={el:e.layer.el};var t=new l["default"].Dispatcher(e);return this.listenTo(t,"didDisappear",function(t){e.layer.$el.addClass(c["default"].IS_HIDDEN)}),this.listenTo(t,"ready",function(){e.layer.$el.removeClass(c["default"].IS_HIDDEN)}),t}});var f=h.prototype;f.getLayerBelow=f.below,f.getLayerAbove=f.above,exports["default"]=h},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(23),a=n(s),o=a["default"].extend();r["default"].extend(o.prototype,{render:function(){return this}}),exports["default"]=o},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(23),l=n(o),u=t(13),c=n(u),h=t(26),f=n(h),d=t(9),p=n(d),g=l["default"].extend();r["default"].extend(g.prototype,{fullscreenEvents:{touch:{touchstart:"_onTouchStart",singleTap:"toggleControls","tap .alf-fullscreen-exit":"exitFullscreen",doubleTap:"exitFullscreen",touchend:"preventDefault"},pointer:{mouseover:"showControls",mouseout:"hideControls","click .alf-fullscreen-exit":"exitFullscreen",dblclick:"exitFullscreen"}},initialize:function(e){e=this.options=r["default"].extend({},e||{}),r["default"].bindAll(this,"_onScroll"),g.__super__.initialize.apply(this,r["default"].toArray(arguments)),this.position=this.$el.css("position"),this.listenTo(p["default"],"fullscreenWillAppear",this._fullscreenWillAppear),e.resizeToWindow=void 0===e.resizeToWindow?!0:e.resizeToWindow,this.delegateEvents(f["default"].touchScreen?this.fullscreenEvents.touch:this.fullscreenEvents.pointer)},tearDown:function(){this.stopListening(),this.$el.empty()},render:function(){return this},renderFullscreenContainer:function(e){var t,n,i=new RegExp("\\s?"+c["default"].REVISION("")+"[^\\s]*");return this.el.className=this.el.className.replace(i,""),n=(0,a["default"])("<div>").addClass(c["default"].BTN_GROUP),n.append((0,a["default"])("<button>").addClass(c["default"].FULLSCREEN_EXIT)),this.$toolbar=(0,a["default"])("<div>").addClass(c["default"].FULLSCREEN_TOOLBAR),this.$toolbar.append(n),this.$content=(0,a["default"])("<div>").addClass(c["default"].FULLSCREEN_CONTENT),this.$content.append(e.el),t=document.createDocumentFragment(),t.appendChild(this.$toolbar[0]),t.appendChild(this.$content[0]),this.$el.empty().removeClass(c["default"].CONTROLS_OFF).addClass(c["default"].REVISION(e.options.revision)).append(t),this.options.resizeToWindow||this.metrics||this._calculateMetrics(),this},toggleControls:function(){this.$el.toggleClass(c["default"].CONTROLS_OFF)},showControls:function(){this.$el.removeClass(c["default"].CONTROLS_OFF)},hideControls:function(){this.$el.addClass(c["default"].CONTROLS_OFF)},exitFullscreen:function(e){e&&(e.stopPropagation(),e.preventDefault());var t=this.below();return this.gestureStarted||t.transition.isRunning()?!1:((0,a["default"])(window).off("mousewheel",this._onMouseWheelScroll).off("scroll touchmove touchend",this._onScroll),t.transition.reverse(),void p["default"].trigger("fullscreenWillDisappear"))},_calculateMetrics:function(){this._windowHeight=window.innerHeight,this._windowWidth=window.innerWidth,this.metrics=this.$el.metrics()},_onTouchStart:function(e){var t,n=(0,a["default"])(e.target);t=n.css("overflow"),"scroll"!==t&&"auto"!==t&&e.preventDefault()},_onGestureStart:function(e){return this.gestureStarted||this.below().transition.isRunning()?!1:(this.gestureStarted=!0,void this.startTransform(e))},_onGestureChange:function(e){return this.below().transition.isRunning()?!1:void this.transformEventTarget(e)},_onGestureEnd:function(e){var t=this.below();return t.transition.isRunning()?!1:(t.transition.reverse(),void(this.gestureStarted=!1))},_fullscreenWillAppear:function(e){var t;if(t={},this.options.resizeToWindow&&(t.width=window.innerWidth+"px",t.height=window.innerHeight+"px"),"fixed"!==this.position){this.x=window.pageXOffset,this.y=window.pageYOffset;var n="translate("+this.x+"px, "+this.y+"px)";t[f["default"].prefixStyle("transform")]=n,t.transform=n}this.$el.css(t),(0,a["default"])(window).on("mousewheel",this._onMouseWheelScroll).on("scroll touchmove touchend",this._onScroll)},_onMouseWheelScroll:function(e){e.preventDefault()},_onScroll:function(e){if("fixed"!==this.position&&(this.y!==window.pageYOffset||this.x!==window.pageXOffset)){this.y=window.pageYOffset,this.x=window.pageXOffset;var t="translate("+this.x+"px, "+this.y+"px)",n={transform:t};n[f["default"].prefixStyle("transform")]=t,this.$el.css(n)}}}),exports["default"]=g},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){console[e].apply(console,[].slice.call(arguments))}}Object.defineProperty(exports,"__esModule",{value:!0});var r=t(1),s=n(r),a="undefined"!=typeof window,o={touchScreen:a&&"ontouchstart"in window,getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getVendorPrefix:s["default"].memoize(function(e){var t=["","webkit","moz","ms"];return e=o.camelize(e),s["default"].find(t,function(t){return void 0!==document.body.style[t+e]})}),prefixStyle:function(e,t){var n=o.getVendorPrefix(e);return t?n+o.camelize(e):"-"+n+"-"+e},camelize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},matchMedia:"undefined"!=typeof window&&window.matchMedia&&s["default"].bind(window.matchMedia,window)};o.dom={getFieldMap:function(e){var t=e.getAttribute("data-map");return t?t.split(" "):[]},getMediaQuery:function(e){return e.getAttribute("data-media")}},a&&!window.console&&(window.console={}),a&&!window.console.log&&s["default"].each(["log","warning","error","info"],function(e){window.console[e]=function(){return{}}}),o.console={log:i("log"),warn:i("warn"),error:i("error"),info:i("info"),debug:i("debug"),groupCollapsed:i("groupCollapsed"),group:i("group"),groupEnd:i("groupEnd")},exports["default"]=o},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(28),r=n(i),s=t(36),a=n(s),o=t(53),l=n(o),u=t(52),c=n(u),h=t(56),f=n(h),d=t(37),p=n(d);exports["default"]={Article:r["default"],Page:a["default"],Template:l["default"],TemplateManager:c["default"],Content:f["default"],Format:p["default"]}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};Object.defineProperty(exports,"__esModule",{value:!0});var r=t(3),s=n(r),a=t(1),o=n(a),l=t(26),u=n(l),c=t(12),h=n(c),f=t(29),d=n(f),p=t(34),g=n(p),m=t(35),v=n(m),_=t(37),y=n(_),b=t(13),w=n(b),E=t(52),T=n(E),x=t(36),S=n(x),C=t(56),P=n(C),M=h["default"].extend();o["default"].extend(M.prototype,g["default"],d["default"],{initialize:function(e){e=this.options=o["default"].extend({revision:"no-rev"},e||{}),o["default"].bindAll(this,"render"),this.templates=null,this.overrideTemplates={},this.layer=e.layer||null,this.fullscreenLayer=e.fullscreenLayer||this.layer&&this.layer.above()||null,this.pages={},this.numberOfPages=0,this.format=e.format||null,this.defaultMetrics(e.metrics),e.content&&this.setContent(e.content),this.setupWidgets(e),e.templates&&this.setTemplates(e.templates)},tearDown:function(){o["default"].invoke(this.pages,"tearDown")},render:function(){return this},discard:function(){o["default"].invoke(this.pages,"tearDown"),this.pages={},this.overrideTemplates={},this.numberOfPages=0},compile:function(){var e=new v["default"](this);return e.compile()},decompile:function(e){var t=new v["default"](this);return t.decompile(e),this},setTemplates:function(e){var t=this.templates||[];return e=T["default"].getEligibleTemplatesForArticle(this,e),t&&t.length?void(this.templates=o["default"].map(e,function(e){var n=o["default"].find(t,function(t){return t.name===e.name});return n&&(n.setElement(e.el),this._reloadPagesUsingTemplate(n)),n||e},this)):void(this.templates=e)},_reloadPagesUsingTemplate:function(e){o["default"].each(this.pages,function(t){t.template===e&&(t.template=null,t.setTemplateIfUsable(e))})},setTemplateForPageNum:function(e,t){this.overrideTemplates[t]=e,this.pages[t]&&(this.pages[t].hasOverrideTemplate=!0)},revert:function(e){for(var t in this.pages)e>t||!this.pages[t]||this.pages[t].revert()},reflow:function(e){o["default"].each(["prepareToReflow","reflow"],function(t){for(var n in this.pages)e>n||!this.pages[n]||this.pages[n][t]()},this)},renderPage:function(e,t){var n,i;return this._calcContentMetrics(e),n=o["default"].isObject(t)?t:this._getOrCreatePageForPageNum(t),i=this.overrideTemplates[n.pageNum],n.prepareToRender(),e.innerHTML="",(0,s["default"])(e).append(n.el),n.render(),n.hasOverrideTemplate=!(!i||i!==n.template),n},renderPages:function(e,t){var n;for(t=t||0,this._calcContentMetrics(e);!this.content.isEmpty()&&(n=this._doRenderPage(e,t));)this.pages[t]=n,t+=1;return this.numberOfPages=this.getNumberOfPagesInUse(),o["default"].invoke(this.pages,"allPagesDidRender",this.numberOfPages),this},getNumberOfPagesInUse:function(){var e=0;for(var t in this.pages)this.pages[t].pageTemplate.didRetainElements()?e+=1:(this.pages[t].tearDown(),delete this.pages[t]);return e},setContent:function(e){if(e instanceof P["default"])this.content=e;else{if(!o["default"].isPlainObject(e))throw new Error("Unsupported data in setContent: "+("undefined"==typeof e?"undefined":i(e)));this.content=new P["default"](e)}},findContainerInElement:function(e){var t,n;return n=(0,s["default"])(e),n=n.is("."+w["default"].CONTAINER)?n:n.find("."+w["default"].CONTAINER),n.length?(o["default"].each(this.pages,function(e){return t=o["default"].find(e.pageTemplate.containers,function(e){return e.el===n[0]}),t?!1:void 0}),t):!1},_getOrCreatePageForPageNum:function(e){var t=this.pages[e],n=this.overrideTemplates[e];return t||(t=this.createPage(e)),t.rendered?t:(t.scoredTemplates=T["default"].getScoredTemplatesForPage(t,this.templates.slice(0)),t.templates=o["default"].pluck(t.scoredTemplates,"template"),n&&t.setTemplateIfUsable(n)||t.setupBestTemplate()?t:!1)},createPage:function(e){var t=this.metrics;return new S["default"]({className:this.content.className,content:this.content,layer:this.layer,fullscreenLayer:this.fullscreenLayer,widgets:this.widgets,fullscreenWidgets:this.fullscreenWidgets,pageNum:e,format:this.format,revision:this.options.revision,metrics:{height:t.height,width:t.width,lineHeight:t.lineHeight}})},_doRenderPage:function(e,t){for(var n,i=0;;){if(n=this._getOrCreatePageForPageNum(t),!n)return!1;if(this.renderPage(e,n),n.pageTemplate.didRetainElements())return n;if(u["default"].console.warn("Page "+t+" did not retain any elements on attempt "+i,"left:",this.content.elementsLeft),i+=1,i>1||!this.overrideTemplates[t])return u["default"].console.warn("stopped trying after "+i+" attempts"),!1;this.overrideTemplates[t]=null}},_getSampleTemplate:function(){var e=0;return o["default"].find(this.templates,function(t){return t.regions&&t.regions.length>e})},_calcContentMetrics:function(e){if(!this.hasCalculatedMetrics){this.setMetrics((0,s["default"])(e).metrics()),this.format&&this.format instanceof y["default"]&&(this.metrics.height=this.format.get("height"),this.metrics.width=this.format.get("width"));var t,n=this._getSampleTemplate();if(!n)return void u["default"].console.warn("No sample template found. Failed to precalculate metrics for ",this);n=T["default"].getPageTemplateFromTemplate(n),t=n.regions,n.$el.css("visibility","hidden"),n.$el.addClass(w["default"].REVISION(this.options.revision)),e.appendChild(n.el),this._calcBlockMetrics(t[0].el),e.removeChild(n.el),t[0].$el.empty(),this.hasCalculatedMetrics=!0}},_calcBlockMetrics:function(e){var t=this.content.getBlocks(),n=document.createDocumentFragment();o["default"].each(t,function(e){n.appendChild(e.render().el)}),e.appendChild(n),o["default"].each(t,function(e){e.calculateMetrics()})}}),exports["default"]=M},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(30),a=n(s),o=t(31),l=n(o);exports["default"]={setupWidgets:function(e){var t;this.widgets=e.widgets,e.widgets instanceof a["default"]||(this.widgets=new a["default"](l["default"]),t=r["default"].isArray(e.widgets),r["default"].each(e.widgets,function(e,n){this.widgets.add(e,t?void 0:n)},this))}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(11),r=n(i),s=t(1),a=n(s),o=r["default"].extend({initialize:function(e){this.widgets=[],a["default"].isPlainObject(e)&&a["default"].each(e,function(e,t){this.add(e,t)},this)},add:function(e,t){this.widgets.push(this.normalize(e,t))},normalize:function(e,t){if("function"==typeof e&&(e={run:e}),a["default"].defaults(e,{compile:!1,render:function(){},run:function(e){e()},fullscreen:function(e,t){t()},selector:t}),!e.selector)throw new Error("Failed to normalize widget. No selector found!");return e},getMatchesForContainer:function(e){var t=[];return this.each(function(n){var i=e.$el.is(n.selector)?e.$el:e.$el.find(n.selector);i.length&&t.push({container:e,widget:n,$el:i,el:i[0]})},this),t}});a["default"].each(["each","map","isEmpty","filter"],function(e){o.prototype[e]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this.widgets),a["default"][e].apply(a["default"],t)}}),exports["default"]=o},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=(0,s["default"])('<div class="alf-slideshow-nav">'),i=(0,s["default"])('<a class="alf-slideshow-nav-next"></a>'),r=(0,s["default"])('<a class="alf-slideshow-nav-prev"></a>');n.append(r).append(i),e.append(n),r.on("dblclick",!1),i.on("dblclick",!1),r.on("click",function(){return t.gotoPrevPage(),!1}),i.on("click",function(){return t.gotoNextPage(),!1});var a=t.options.numberOfPages;r.addClass("alf-is-hidden"),t.on("pageWillAppear",function(e,t){0===t?r.addClass("alf-is-hidden"):t>0&&a-1>t?(r.removeClass("alf-is-hidden"),i.removeClass("alf-is-hidden")):t===a-1&&i.addClass("alf-is-hidden")})}Object.defineProperty(exports,"__esModule",{value:!0});var r=t(3),s=n(r),a=t(26),o=n(a),l=t(32),u=n(l);exports["default"]={".alf-slideshow":{compile:!0,render:function(){var e,t,n;e=(0,s["default"])("<div>").css({position:"relative",top:0,left:0}),t=(0,s["default"])("<div>").addClass("alf-slideshow-toggle alf-fullscreen-toggle alf-is-draggable"),this.$el.children(":not(:first-child)").remove(),e.append(t).append(this.$el),n=(0,s["default"])("<div>").addClass("alf-slideshow-stack"),this.$el.addClass("alf-slideshow-inline").prepend(n.clone().addClass("alf-slideshow-stack-1")).prepend(n.clone().addClass("alf-slideshow-stack-2")),this.container.$el.append(e)},run:function(e){var t=this.container.$el.find(".alf-slideshow-toggle");t.length&&"none"!==t.css("display")&&this.container.preventDefaultEvents(),this.container.$el.on(o["default"].touchScreen?"tap":"click",".alf-fullscreen-toggle",this.container.enterFullscreen).on("touchend",".alf-fullscreen-toggle",function(e){e.preventDefault()}),e()},fullscreen:function(e,t){var n,r,a,l;a=e.$el.find(".alf-slideshow").children().clone(),l=a.length,r=(0,s["default"])('<button class="alf-slideshow-progress"></button>'),r.text("1/"+l),e.layer.$toolbar.append(r),n=(0,s["default"])('<div class="alf-slideshow"><div class="alf-pages"><div class="alf-page alf-page-1"><section class="alf-page-loader swiper-page-is-loading"></section><section class="alf-page-content"></section></div><div class="alf-page alf-page-2"><section class="alf-page-loader swiper-page-is-loading"></section><section class="alf-page-content"></section></div><div class="alf-page alf-page-3"><section class="alf-page-loader swiper-page-is-loading"></section><section class="alf-page-content"></section></div></div></div>'),e.$el.empty().append(n);var c=new u["default"](n[0],{numberOfPages:a.length,enableKeyNavigation:!0});c.on("pageWillRender",function(e,t){(0,s["default"])(e).empty().append(a[t])}),c.on("pageWillAppear",function(e,t){r.text(t+1+"/"+l)}),c.start(),o["default"].touchScreen||i(e.layer.$content,c),t()}},".alf-stretch-to-fit h1":{compile:!0,render:function(){this.$el.textFit()}}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(33),r=n(i);exports["default"]=r["default"]},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=5,n=["_onMove","_onMoveStart","_onMoveEnd","_onMoveStartCapture","_onMoveCapture","_onMoveEndCapture","_onTransitionEnd","_onKeyPress","_refresh","_renderPages"],i=Array.prototype.slice,r=function(e,t,n){return i.call(e).forEach(t,n)},s=function(e,t){var i=this,s=e.children[0];n.forEach(function(e){i[e]=i[e].bind(i)}),this.el=e,this.elements={pageContainer:s,pages:[],scrollablePages:[]},r(s.children,function(e,t){this.elements.pages.push({el:e,offset:100*t,pageNum:t}),e.classList.contains("is-scrollable")&&this.elements.scrollablePages.push(e)},this),this.concurrentPages=this.elements.pages.length,t=t||{},t.overflowScrolling=t.overflowScrolling||!1,t.renderDeferTime=t.renderDeferTime||200,t.scrollDuration=t.scrollDuration||320,t.tapToFlip=t.tapToFlip||!1,t.loadingClass=t.loadingClass||"swiper-page-is-loading",t.enableKeyNavigation=void 0===t.enableKeyNavigation?!0:t.enableKeyNavigation,this.options=t,this.events={},this.renderTimeout=null,this.pageFlipWidth=50,this.x=0,this.currentPage=0};s.prototype={start:function(){this.pageWidth=this.elements.pages[0].el.clientWidth,this.windowWidth=window.innerWidth,this._renderPages(),this.enable()},gotoPage:function(e,t,n){var i,r,s=this,a=this.x||0;t=void 0!==t?t:this.options.scrollDuration,n=0===t?!1:n,e=parseInt(e,10),clearTimeout(this.renderTimeout),0>e||isNaN(e)||0===this.options.numberOfPages?e=0:e>this.options.numberOfPages-1&&(e=this.options.numberOfPages-1),this.prevPage=this.currentPage,this.currentPage=e,e>0&&e<this.options.numberOfPages-1&&this._positionPages(),this.x=e*this.pageWidth*-1,this._moveX(this.elements.pageContainer,this.x+"px",t),n&&a!==this.x||this._onPageChange(!0),this.prevPage!==this.currentPage&&(i=this.elements.pages[e%this.concurrentPages],s.trigger("pageWillAppear",i.el.children[1],e),r=this.elements.pages[this.prevPage%this.concurrentPages],s.trigger("pageWillDisappear",r.el.children[1],this.prevPage))},on:function(e,t,n){var i=this.events[e]||(this.events[e]=[]);i.push({callback:t,context:n||this})},trigger:function(e){var t,n=this.events[e];if(n){t=i.call(arguments,1);for(var r in n)n[r].callback.apply(n[r].context,t)}},enable:function(){var e=this.elements.pageContainer;this._disableOverflowScrolling(),e.addEventListener("touchstart",this._onMoveStartCapture,!0),e.addEventListener("webkitTransitionEnd",this._onTransitionEnd,!0),e.addEventListener("transitionend",this._onTransitionEnd,!0),window.addEventListener("keydown",this._onKeyPress,!1),window.addEventListener("resize",this._refresh,!0)},disable:function(){this._enableOverflowScrolling(),this.elements.pageContainer.addEventListener("touchstart",this._onMoveStartCapture,!0),window.removeEventListener("keydown",this._onKeyPress,!1),window.removeEventListener("resize",this._refresh,!0)},gotoCurrentPage:function(e){this.gotoPage(this.currentPage,e)},gotoPrevPage:function(){this.gotoPage(this.currentPage-1,this.options.scrollDuration)},gotoNextPage:function(){this.gotoPage(this.currentPage+1,this.options.scrollDuration)},refresh:function(e){r(this.elements.pages,function(e){e.prevPage=void 0}),e=e||{};for(var t in e)this.options[t]=e[t];this.trigger("refresh"),this.gotoPage(this.currentPage,void 0,!1)},reset:function(e){this.prevPage=void 0,r(this.elements.pages,function(e){e.prevPage=void 0===e.prevPage?void 0:null,e.pageNum=null}),e=e||{};for(var t in e)this.options[t]=e[t];this.trigger("refresh"),this.gotoPage(0,0,!1)},_positionPages:function(){var e=this,t=this.currentPage,n=(this.concurrentPages-1)/2,i=t-n,r=t+n;i=0>i?0:i,r=r<this.options.numberOfPages?r:this.options.numberOfPages-1;for(var s=i;r>=s;s++){var a=this.elements.pages[s%this.concurrentPages],o=100*s,l=a.el.children[0];a.prevOffset=void 0===a.offset?o:a.offset,a.offset=o,a.prevOffset!==a.offset&&(l.classList.add(e.options.loadingClass),this._moveX(a.el,a.offset+"%"))}},_renderPage:function(e,t){var n=e.el.children[1],i=void 0===e.prevPage;e.prevPage=e.pageNum,e.pageNum=t,(i||e.prevPage!==e.pageNum)&&(n.scrollTop=0,n.scrollLeft=0,i||this.trigger("pageWillDestruct",n,e.prevPage),this.trigger("pageWillRender",n,t)),e.el.children[0].classList.remove(this.options.loadingClass)},_renderPages:function(){for(var e,t,n=this,i=this.currentPage,r=i,s=this.options,a=this.elements.pages,o=i<=this.prevPage?1:-1,l=0;l<this.concurrentPages;l++)r+=l*o,o*=-1,e=a[r%this.concurrentPages],!e||r>s.numberOfPages-1||n._renderPage(e,r);n.trigger("pageDidAppear",a[i%this.concurrentPages].el.children[1],i),t=a[this.prevPage%this.concurrentPages],t&&n.trigger("pageDidDisappear",t.el.children[1],this.prevPage)},_refresh:function(e){this.pageWidth=this.elements.pages[0].el.clientWidth,this.windowWidth=window.innerWidth,this.gotoCurrentPage()},_onKeyPress:function(e){if(this.options.enableKeyNavigation)switch(e.keyCode){case 37:this.gotoPrevPage();break;case 39:this.gotoNextPage()}},_onMoveStartCapture:function(e){var t=this.elements.pageContainer;this.moved=!1,this.pointX=e.touches[0].pageX,this.pointY=e.touches[0].pageY,this.deltaX=0,this.deltaY=0,this.distX=0,this.distY=0,this.directionCalc=!1,this.multitouch=e.touches.length>1,this.multitouch?(this._disableOverflowScrolling(),t.removeEventListener("touchmove",this._onMoveCapture,!0),t.removeEventListener("touchend",this._onMoveEndCapture,!0)):(t.addEventListener("touchmove",this._onMoveCapture,!0),t.addEventListener("touchend",this._onMoveEndCapture,!0)),t.addEventListener("touchstart",this._onMoveStart,!1)},_onMoveCapture:function(e){var t=this.elements.pageContainer,n=e.touches[0].pageX,i=e.touches[0].pageY;this.multitouch||(this.deltaX=n-this.pointX,this.deltaY=i-this.pointY,this.pointX=n,this.pointY=i,this.directionCalc||(this.distX<4&&this.distY<4&&(this.distX+=Math.abs(this.deltaX),this.distY+=Math.abs(this.deltaY),this.directionCalc=!0),this.distY<2||this.distX>this.distY+5?(this._disableOverflowScrolling(),t.addEventListener("touchmove",this._onMove,!1),t.addEventListener("touchend",this._onMoveEnd,!1)):(this.distX<2||this.distY>this.distX+5)&&this._enableOverflowScrolling()))},_onMoveEndCapture:function(e){if(this.elements.pageContainer.removeEventListener("touchstart",this._onMoveStart,!1),this._disableOverflowScrolling(),this.options.tapToFlip&&!this.moved){if(this.pointX<this.pageFlipWidth)return void this.gotoPrevPage();if(this.pointX>this.windowWidth-this.pageFlipWidth)return void this.gotoNextPage()}},_onMoveStart:function(e){this.startX=e.touches[0].pageX,this.startY=e.touches[0].pageY},_onMove:function(e){e.preventDefault(),clearTimeout(this.renderTimeout),this.moved=!0,(this.x>0||this.currentPage===this.options.numberOfPages-1&&this.x<0)&&(this.deltaX*=.5),this.x+=this.deltaX,this._moveX(this.elements.pageContainer,Math.round(this.x)+"px",0)},_onMoveEnd:function(){var e=this.elements.pageContainer,n=this.startX-this.pointX,i=Math.abs(n),r=Math.abs(this.deltaX),s=this.pageWidth/2,a=this.options.scrollDuration;this.elements.pageContainer.style.webkitTransitionDuration=a+"ms",this.elements.pageContainer.style.MozTransitionDuration=a+"ms",e.removeEventListener("touchmove",this._onMove,!1),e.removeEventListener("touchend",this._onMoveEnd,!1),this._disableOverflowScrolling(),s>i&&t>r?this.gotoCurrentPage():n>0?this.gotoNextPage():this.gotoPrevPage()},_moveX:function(e,t,n){void 0!==n&&(e.style.webkitTransitionDuration=n+"ms",e.style.MozTransitionDuration=n+"ms"),e.style.webkitTransform="translate3d("+t+", 0, 0)",e.style.MozTransform="translate("+t+", 0)"},_onPageChange:function(e){e?this._renderPages():this.renderTimeout=setTimeout(this._renderPages,this.options.renderDeferTime)},_onTransitionEnd:function(e){-1!==e.propertyName.indexOf("transform")&&this._onPageChange();
},_preventDefaultEvent:function(e){e.preventDefault()},_disableOverflowScrolling:function(){if(this.options.overflowScrolling){var e=this;r(this.elements.scrollablePages,function(t){t.addEventListener("touchmove",e._preventDefaultEvent,!0)})}},_enableOverflowScrolling:function(){if(this.options.overflowScrolling){var e=this;r(this.elements.scrollablePages,function(t){t.removeEventListener("touchmove",e._preventDefaultEvent,!0)})}}},s.prototype.destroy=s.prototype.disable,exports["default"]=s,Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i?this:e||window,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r})},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(13),a=n(s);t(3),exports["default"]={isInline:!1,defaultMetrics:function(e){this.metrics=r["default"].extend({height:0,width:0,outerHeight:0,lineHeight:24,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,marginHeight:0,marginWidth:0},this.metrics||{},e||{})},setMetrics:function(e){this.metrics=r["default"].extend(this.metrics||{},e)},calculateMetrics:function(){if(!this.el.children.length)return void(this.metrics=this.$el.metrics());var e=parseInt(window.getComputedStyle(this.el).getPropertyValue("border-bottom-width"),10);return e?void(this.metrics=this.$el.metrics()):(this.isInline||(this.el.style.borderBottom="1px solid transparent"),this.metrics=this.$el.metrics(),void(this.isInline||(this.el.style.removeProperty("border-bottom"),this.metrics.outerHeight-=1)))},lockSize:function(){var e=this.metrics;this.$el.css({height:e.height+"px",width:e.width+"px"})},isTextElement:function(){return-1!==["P","H1","H2","H3","H4","H5","H6","HEADER","SPAN"].indexOf(this.el.tagName)},normalize:function(e,t){if(!this._isNormalized){var n={},i=this.$el.hasClass(a["default"].CONTAINER),s=this.metrics,o=0;this._normalizeTopMargin(n),t=t||0;var l=Math.min(t,s.marginTop);e=e||s.lineHeight,o=(s.outerHeight-l)%e,0===o||i||(o=e-o,s.marginBottom+=o,s.marginHeight+=o,s.outerHeight+=o,n["margin-bottom"]=s.marginBottom+"px"),this._isNormalized=!0,r["default"].isEmpty(n)||this.$el.css(n)}},_normalizeTopMargin:function(e){var t=this.metrics;t.marginTop>0&&this.isTextElement()&&(t.outerHeight-=t.marginTop,t.marginHeight-=t.marginTop,t.marginTop=0,e["margin-top"]=0)}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(11),l=n(o),u=t(36),c=n(u),h=t(13),f=n(h),d=l["default"].extend({initialize:function(e){this.article=e,this.compiled={}},compile:function(){var e,t=this.article.content.toJSON();return t.meta.articleId=t.meta.articleId||t.meta.id,delete t.meta.id,e=r["default"].map((0,a["default"])("."+f["default"].ASSET_STYLESHEET),function(e){return e.href}),t.compiled={},t.compiled.pages=r["default"].map(this.article.pages,function(e){return e.compile()}),t.compiled.assets={stylesheets:e,revision:this.article.options.revision},t},decompile:function(e){var t=r["default"].isObject(e)?e:JSON.parse(e),n=t.compiled.assets.revision;n&&(this.article.options.revision=n),this.article.pages=r["default"].map(t.compiled.pages,function(e){var i=new c["default"]({revision:n,assetsBaseUrl:t.service.assetsBaseUrl});return i.decompile(e),i})}});exports["default"]=d},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(3),r=n(i),s=t(1),a=n(s),o=t(12),l=n(o),u=t(37),c=n(u),h=t(39),f=n(h),d=t(40),p=n(d),g=t(52),m=n(g),v=t(34),_=n(v),y=t(29),b=n(y),w=t(13),E=n(w),T=t(26),x=n(T),S=l["default"].extend();a["default"].extend(S.prototype,_["default"],b["default"],{className:"page",initialize:function(e){e=this.options=a["default"].extend({revision:"no-rev"},e||{}),a["default"].bindAll(this,"render"),this.decompiled=!1,this.pageNum="number"==typeof e.pageNum?e.pageNum:null,this.className=e.className||"",this.content=e.content||null,this.layer=e.layer||null,this.fullscreenLayer=e.fullscreenLayer||this.layer&&this.layer.above()||null,this.templateManager=e.templateManager||m["default"],this.format=e.format||null,e.pixelRatio=parseInt(e.pixelRatio||window.devicePixelRatio||1,10),this.defaultMetrics(e.metrics),this.setupWidgets(e)},tearDown:function(){this.el=null,this.pageTemplate&&this.pageTemplate.tearDown(),this.pageTemplate=null,this.content=null,this.fullscreenLayer&&this.fullscreenLayer.hide()},revert:function(){this.rendered=!1,this.pageTemplate.revert()},restoreFromHtml:function(e){this.setElement((0,r["default"])(e)),this.setPageTemplate(new p["default"]({el:this.el.children[0]})),this.rendered=!0},getBestTemplate:function(){var e;return e=this.templateManager.getBestTemplateForPage(this,this.templates),e.template?e:(x["default"].console.warn("No template found for page "+this.pageNum+"! Remaining elements: "+this.content.elementsLeft),!1)},setupBestTemplate:function(){var e=this.getBestTemplate();return e?(this.setTemplate(e.template,e.containerMap,e.score),!0):!1},setTemplate:function(e,t){return this.rendered=!1,this.score=t||0,this.template===e?(this.pageTemplate.reload(),this):(this.template=e,this.setPageTemplate(this.templateManager.getPageTemplateFromTemplate(e,{page:this})),this)},setTemplateIfUsable:function(e){var t,n=e.getContainerMap(this.content);return t=!e.containers||!e.containers.length,(t=t||a["default"].all(n.positions,function(e){return e.isOptional||e.match}))?(this.setTemplate(e,n),!0):(x["default"].console.warn("Page ",this.pageNum,": Template ",e.name,"is no longer usable"),!1)},setPageTemplate:function(e){this.pageTemplate=e,this.$el.empty(),this.$el.append(this.pageTemplate.el),this.containers=this.pageTemplate.containers,this.regions=this.pageTemplate.regions},prepareToRender:function(){var e=[];return this.rendered||!this.template?this:(this.className&&e.push(this.className),e.push(E["default"].REVISION(this.options.revision)),e.push(E["default"].PAGENUM_X(this.pageNum+1)),this.$el.addClass(e.join(" ")),void this.pageTemplate.prepareToRender())},render:function(e){return!this.rendered&&this.decompiled?this._renderCompiled(e):this._pendingReflow?(this._pendingReflow=!1,this.reflow(),this):this.template?this.rendered?(this.pageTemplate.loadContainers(),this):(this._setupMetrics(),this.pageTemplate.render(),this.rendered=!0,e&&this._appendToEl(e),this):this},allPagesDidRender:function(e){var t,n=E["default"].PAGENUM_X("last"),i=E["default"].PAGENUM_TOTAL_X(""),r=[E["default"].PAGENUM_TOTAL_X(e)];t=new RegExp(" ?("+n+"|"+i+"[\\d]*)","g"),e===this.pageNum+1&&r.push(n),this.el.className=this.el.className.replace(t,""),this.$el.addClass(r.join(" "))},play:function(){this.$el.addClass(E["default"].IS_PLAYING)},stop:function(){this.$el.removeClass(E["default"].IS_PLAYING)},prepareToReflow:function(){this.pageTemplate.prepareToReflow()},reflow:function(){return this.isInDOM()?void this.pageTemplate.reflow():void(this._pendingReflow=!0)},lockSize:function(){this.pageTemplate.isResponsive||this.$el.css({width:this.metrics.width+"px",height:this.metrics.height+"px",overflow:"hidden",position:"relative"})},compile:function(){var e=new f["default"](this);return e.compile()},decompile:function(e,t){var n=new f["default"](this);return n.decompile(e,t),this},_renderCompiled:function(e){return e&&this._appendToEl(e),this._setupMetrics(),this.pageTemplate.decompile(),this.rendered=!0,this},_appendToEl:function(e){var t=this.el;setTimeout(function(){(0,r["default"])(e).empty().append(t)},0)},_setupMetrics:function(){var e=this.$el.metrics();this.format&&this.format instanceof c["default"]&&(e.height=this.format.get("height"),e.width=this.format.get("width")),!e.height&&this.metrics.height&&(e.height=this.metrics.height,e.outerHeight=this.metrics.outerHeight),this.metrics=e,this.pageTemplate.metrics=e,e.contentHeight=e.height-e.marginHeight-e.paddingTop-e.paddingBottom,e.contentWidth=e.width-e.marginWidth-e.paddingRight-e.paddingLeft}}),exports["default"]=S},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(38),r=n(i),s=r["default"].extend({defaults:{title:"",name:"",width:0,height:0},initializeFromWindow:function(){return this.set({width:window.innerWidth,height:window.innerHeight,name:"window",title:"Window"}),this}});exports["default"]=s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(10),r=n(i);exports["default"]=r["default"].Model.extend({})},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(11),l=n(o),u=t(40),c=n(u),h=t(13),f=n(h),d=t(51),p=n(d),g=t(41),m=n(g),v={classNames:[f["default"].IS_DRAGGABLE,f["default"].IS_DRAGGABLE_X,f["default"].IS_DRAGGABLE_Y,f["default"].IS_EDITABLE,f["default"].IS_OPTIONAL,f["default"].IS_REMOVABLE,f["default"].IS_RESIZABLE,f["default"].MULTI_CHOICE],attributes:["data-filter-format-name","data-filter-page-pos","data-map","data-media","data-name","data-score"],elements:["."+f["default"].SIZE_DETECTOR]},_=l["default"].extend({initialize:function(e){r["default"].bindAll(this,"_doDecompile"),this.page=e,this.compiled={v:1,elements:{},assets:{images:[]}}},compile:function(){return this.page.lockSize(),this.compiled.html=this._getCompiledHtml(),this._compileImages(),this._compileStylesheets(),this.compiled.assets.revision=this.page.options.revision,this.compiled},decompile:function(e,t){var n;t=t||function(){},this.page.decompiled=!0,this.compiledObject=r["default"].isObject(e)?e:JSON.parse(e),this.compiledObject.assets.revision&&(this.page.options.revision=this.compiledObject.assets.revision),n=(0,a["default"])(this.compiledObject.html).get(0),this.page.pageTemplate=new c["default"]({el:n.children[0],page:this.page}),this.page.setElement(n),this.promises=this.loadStylesheets(this.compiledObject.assets.stylesheets),m["default"].all(this.promises).then(this._doDecompile).then(t)},strip:function(e){var t,n=(0,a["default"])(e);t="."+v.classNames.join(", ."),n.find("."+f["default"].IS_DISABLED+", ."+f["default"].IS_REMOVED).remove(),n.find(t).removeClass(v.classNames.join(" ")),r["default"].each(v.attributes,function(e){n.find("["+e+"]").removeAttr(e)}),r["default"].each(v.elements,function(e){n.find(e).remove()})},_doDecompile:function(){this.page.containers=this.page.pageTemplate.containers,this.page.regions=this.page.pageTemplate.regions,r["default"].each(this.page.pageTemplate._getAllContainers(),function(e){this.page.layer&&e.setLayer(this.page.layer),this._decompileContainer(e,this.compiledObject.elements[e.el.id])},this)},_decompileContainer:function(e,t){new p["default"](e).decompile(t)},_getCompiledHtml:function(){var e,t,n,i;return e=(0,a["default"])(this.page.el.outerHTML),t=this.compiled,n=this.page.pageTemplate._getAllContainers(),r["default"].each(n,function(n){var s=new p["default"](n).compile();n.isDisabled||n.isRemoved||(t.elements[n.id]=s,n.fullscreenEl&&(i=(0,a["default"])(n.fullscreenEl).find("img[data-src]"),i.length>0&&(t.assets.images=t.assets.images.concat(r["default"].toArray(i)))),e.find("#"+n.id).replaceWith(s.html),delete s.html)}),this.strip(e),e[0].outerHTML},_compileImages:function(){var e,t=this.compiled;e=this.page.$("img[data-src]"),e.length>0&&(t.assets.images=t.assets.images.concat(r["default"].toArray(e))),t.assets.images=r["default"].map(t.assets.images,this._compileImageAsset,this)},_compileImageAsset:function(e){var t=(0,a["default"])(e),n={},i=t.attr("data-src-2x");return n["1x"]=t.attr("data-src"),i&&(n["2x"]=i),{height:parseInt(t.attr("height"),10),width:parseInt(t.attr("width"),10),urls:n}},_compileStylesheets:function(){this.compiled.assets.stylesheets=r["default"].map((0,a["default"])("."+f["default"].ASSET_STYLESHEET),function(e){return e.href})},loadStylesheets:function(e){e=r["default"].map(e,function(e){return-1===e.indexOf("://")?this.page.options.assetsBaseUrl+e:e},this);var t,n=r["default"].filter((0,a["default"])("."+f["default"].ASSET_STYLESHEET),function(e){return this.page.options.revision===e.getAttribute("data-revision")},this),i=[];return r["default"].each(n,function(n){var i=(0,a["default"])(n),r=e.indexOf(i.attr("href"));return-1!==r?void e.splice(r,1):void(e.length?(t=e.shift(),i.attr("href",t),this._trackStylesheetProgress(t)):i.remove())},this),r["default"].each(e,function(e){var t=(0,a["default"])('<link rel="stylesheet" type="text/css">');t.attr({"class":f["default"].ASSET_STYLESHEET,"data-revision":this.page.options.revision}),(0,a["default"])("head").append(t.attr("href",e)),i.push(this._trackStylesheetProgress(e))},this),i},_trackStylesheetProgress:function(e){var t,n;return t=m["default"].defer(),n=document.createElement("img"),this.page.pageTemplate.addDeferred(t),n.onerror=function(){t.resolve()},n.src=e,t}});exports["default"]=_},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(3),r=n(i),s=t(1),a=n(s),o=t(41),l=n(o),u=t(12),c=n(u),h=t(34),f=n(h),d=t(42),p=n(d),g=t(44),m=n(g),v=t(48),_=n(v),y=t(49),b=n(y),w=t(13),E=n(w),T=t(9),x=n(T);t(50);var S=c["default"].extend();a["default"].extend(S.prototype,f["default"],{initialize:function(e){this.options=e,e.page&&this.setPage(e.page),this.template=e.template||null,this.deferreds=[],this.fullscreenContainer=this._getFullscreenContainer()},tearDown:function(){this.stopListening(),a["default"].invoke(this.containers,"tearDown"),a["default"].invoke(this.regions,"tearDown"),this.template=null,this.containers=null,this.regions=null,this.fullscreenContainer&&this.fullscreenContainer.tearDown()},setElement:function(e){S.__super__.setElement.call(this,e),this.isPositionedGrid=!!this.el.className.match(/cols\-([0-9])+/),this.isResponsive=this.$el.hasClass(E["default"].IS_RESPONSIVE),this.reload()},setPage:function(e){this.page=e,this.content=e.content},prepareToRender:function(){this._setupContainers(),this._renderContainers()},render:function(){return this.loadContainers(),this._fit(),this._fillRegions(),this.trackProgress(),this},reload:function(){this._findContainers(),this._findRegions()},prepareToReflow:function(){a["default"].invoke(this.regions,"tearDown"),this._findRegions()},reflow:function(){this._fit(),this._fillRegions()},revert:function(){this._sizeListener=!1,this.stopListening(),a["default"].invoke(this.regions,"revert"),a["default"].invoke(this.containers,"revert")},decompile:function(){this.decompiled=!0,this.loadContainers(!0,this._getAllContainers()),this.trackProgress()},addDeferred:function(e){this.deferreds.push(e)},didRetainElements:function(){return a["default"].some(this.containers.concat(this.regions),function(e){return e.didRetainElements()})},loadContainers:function(e,t){var n=this.deferreds;return this._setupSizeDetector(),t=t||this.containers,a["default"].each(t,function(t){this._prepareContainerForLoad(t,e),t.load(),n=n.concat(t.deferreds)},this),this.deferreds=n,this},trackProgress:function(){var e=this.page,t=function(){e.trigger("loadComplete",e),x["default"].trigger("loadComplete",e)};this.deferreds.length?l["default"].all(this.deferreds,t):t()},_findContainers:function(){var e=this,t=this.containers;this.containers=a["default"].map(this.$el.find("."+E["default"].CONTAINER),function(n){var i;return i=a["default"].find(t,function(e){return e.el===n}),i||(i=new m["default"]({el:n}),i.isResponsive=e.isResponsive),i})},_findRegions:function(){var e=this.regions,t=this.isPositionedGrid;this.regions=a["default"].map(this.$el.find("."+E["default"].REGION),function(n){return a["default"].find(e,function(e){return e.el===n})||new p["default"]({el:n,isPositionedGrid:t||(0,r["default"])(n).closest(".alf-grid",this.$el).length>=1})},this)},_getAllContainers:function(){var e=a["default"].flatten(a["default"].pluck(this.regions,"containers"));return e.concat(this.containers)},_setupSizeDetector:function(){return this.sizeDetector?void this.sizeDetector.start():void(this.sizeDetector=new b["default"]({target:this.el,watch:this.isResponsive}).render())},_setupContainers:function(){function e(e,t){if(!(e.isRemoved||e.isDisabled||e.rendered)){var n=a["default"].filter(i,function(n){return t.call(this,e,n)});if(!n.length)return void(e.isOptional&&e.disable());e.content=this.content,e.matchingFigureElements=a["default"].flatten(a["default"].pluck(n,"mappedElements")),e.useBestMatchingFigureEl(),e.ref&&(e.figure.ref=e.ref)}}function t(e,t){if(t.retained)return!1;var n=t.getElementsMappedToField(e.fieldMap);return n.length?(t.mappedElements=n,t):!1}function n(e,t){return e.ref&&e.ref===t.ref?t:!1}var i=this.page.content.getFigures();a["default"].each(this.containers,function(n){n.fieldMap.length&&e.call(this,n,t)},this),a["default"].each(this.containers,function(t){t.fieldMap.length||e.call(this,t,n)},this)},_getFullscreenContainer:function(){var e=this.$el.find("."+E["default"].CONTAINER_FULLSCREEN)[0];return e?new _["default"]({el:e.cloneNode(!0),page:this,layer:this.page?this.page.fullscreenLayer:!1,revision:this.page&&this.page.options.revision}):!1},_fit:function(){var e=this.page.metrics,t={lineHeight:e.lineHeight,prefix:"alf-"},n=this.$el.find(".alf-grid");this.isPositionedGrid&&this.$el.grid(t),a["default"].each(n,function(e){(0,r["default"])(e).grid(t)}),a["default"].each(this.regions,function(t){t.metrics=t.$el.metrics(),t.metrics.contentHeight=0,t.metrics.lineHeight=e.lineHeight},this)},_renderContainers:function(){return a["default"].invoke(this.containers,"render"),this},_prepareContainerForLoad:function(e,t){var n,i;n=this.page.widgets,i=this.fullscreenContainer,e.page=this.page,e.setLayer(this.page.layer),e.matchingWidgets=n.getMatchesForContainer(e),e.options.pixelRatio=this.page.options.pixelRatio,e.renderWidgets(),e.unload(),t||(e.metrics=e.$el.metrics(),this.isResponsive||e.normalize()),i&&i.subscribeToContainer(e)},_fillRegions:function(){for(var e=this.page.content,t=[],n=0,i=this.regions[n];i&&(i.setContent(e),i.containers.length&&(t=t.concat(i.containers)),e.hasBlocksLeft());)i=this.regions[++n]||!1;this.loadContainers(!0,t)}}),exports["default"]=S},function(e,exports){/** @license MIT License (c) copyright B Cavalier & J Hann */
"use strict";function t(e,t,i,r){return n(e).then(t,i,r)}function n(e){var t,n;return e instanceof r?t=e:l(e)?(n=o(),e.then(function(e){n.resolve(e)},function(e){n.reject(e)},function(e){n.progress(e)}),t=n.promise):t=s(e),t}function i(e){return t(e,a)}function r(e){this.then=e}function s(e){var t=new r(function(t){try{return n(t?t(e):e)}catch(i){return a(i)}});return t}function a(e){var t=new r(function(t,i){try{return i?n(i(e)):a(e)}catch(r){return a(r)}});return t}function o(){function e(e,t,n){return f(e,t,n)}function t(e){return p(e)}function i(e){return p(a(e))}function s(e){return d(e)}var l,u,c,h,f,d,p;return u=new r(e),l={then:e,resolve:t,reject:i,progress:s,promise:u,resolver:{resolve:t,reject:i,progress:s}},c=[],h=[],f=function(e,t,n){var i,r;return i=o(),r="function"==typeof n?function(e){try{i.progress(n(e))}catch(t){i.progress(t)}}:function(e){i.progress(e)},c.push(function(n){n.then(e,t).then(i.resolve,i.reject,r)}),h.push(r),i.promise},d=function(e){return m(h,e),e},p=function(e){return e=n(e),f=e.then,p=n,d=_,m(c,e),h=c=E,e},l}function l(e){return e&&"function"==typeof e.then}function u(e,n,i,r,s){return v(2,arguments),t(e,function(e){function a(e){g(e)}function l(e){p(e)}var u,c,h,f,d,p,g,m,v,y;if(v=e.length>>>0,u=Math.max(0,Math.min(n,v)),h=[],c=v-u+1,f=[],d=o(),u)for(m=d.progress,g=function(e){f.push(e),--c||(p=g=_,d.reject(f))},p=function(e){h.push(e),--u||(p=g=_,d.resolve(h))},y=0;v>y;++y)y in e&&t(e[y],l,a,m);else d.resolve(h);return d.then(i,r,s)})}function c(e,t,n,i){function r(e){return t?t(e[0]):e[0]}return u(e,1,r,n,i)}function h(e,t,n,i){return v(1,arguments),d(e,y).then(t,n,i)}function f(){return d(arguments,y)}function d(e,n){return t(e,function(e){var i,r,s,a,l,u;if(s=r=e.length>>>0,i=[],u=o(),s)for(a=function(e,r){t(e,n).then(function(e){i[r]=e,--s||u.resolve(i)},u.reject)},l=0;r>l;l++)l in e?a(e[l],l):--s;else u.resolve(i);return u.promise})}function p(e,n){var i=w.call(arguments,1);return t(e,function(e){var r;return r=e.length,i[0]=function(e,i,s){return t(e,function(e){return t(i,function(t){return n(e,t,s,r)})})},b.apply(e,i)})}function g(e,n,i){var r=arguments.length>2;return t(e,function(e){return e=r?i:e,n.resolve(e),e},function(e){return n.reject(e),a(e)},n.progress)}function m(e,t){for(var n,i=0;n=e[i++];)n(t)}function v(e,t){for(var n,i=t.length;i>e;)if(n=t[--i],null!=n&&"function"!=typeof n)throw new Error("arg "+i+" must be a function")}function _(){}function y(e){return e}Object.defineProperty(exports,"__esModule",{value:!0});var b,w,E;t.defer=o,t.resolve=n,t.reject=i,t.join=f,t.all=h,t.map=d,t.reduce=p,t.any=c,t.some=u,t.chain=g,t.isPromise=l,r.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(E,e)},"yield":function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return h(t,function(t){return e.apply(E,t)})})}},w=[].slice,b=[].reduce||function(e){var t,n,i,r,s;if(s=0,t=Object(this),r=t.length>>>0,n=arguments,n.length<=1)for(;;){if(s in t){i=t[s++];break}if(++s>=r)throw new TypeError}else i=n[1];for(;r>s;++s)s in t&&(i=e(i,t[s],s,t));return i},exports["default"]=t},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(12),a=n(s),o=t(34),l=n(o),u=t(43),c=n(u),h=t(44),f=n(h),d=t(45),p=n(d),g=t(47),m=n(g),v=t(26),_=n(v),y=t(13),b=n(y),w=a["default"].extend();r["default"].extend(w.prototype,l["default"],c["default"],{className:b["default"].REGION,initialize:function(e){this.options=e||{},this.defaultMetrics(this.options.metrics),this.metrics.contentHeight=0,this.fragment=null,this._contentContainers=[],this.options.elements&&this.addElements(this.options.elements)},tearDown:function(){this.stopListening(),this.fragment=null,this.revert(),this.el=null,this.$el=null},clone:function(){var e=new w({el:this.el.cloneNode(!0)});return e.content=this.content,e},setElement:function(e){w.__super__.setElement.call(this,e),this._originalHtml=this.$el.html(),this.isFlexible=this.$el.hasClass(b["default"].REGION_FLEXIBLE),this._originalContainers=this._getInlineContainers(),this.containers=this._originalContainers.slice(0)},setContent:function(e){this.content=e,this.addElements(e.getElements())},addElements:function(e){return this.$el.empty(),this.fragment=document.createDocumentFragment(),r["default"].forEach(e,this._addElement,this),this.el.appendChild(this.fragment),this.containers=this._contentContainers,this._contentContainers=[],this},getOverflow:function(e){e=e||{};var t=e.outerHeight||0,n=0;return this.lastUsedElement&&(n=Math.min(this.lastUsedElement.metrics.marginBottom,e.marginTop)),this.metrics.contentHeight-this.metrics.height+t-n},hasSpaceLeft:function(){return this.getOverflow()<0},revert:function(e){r["default"].invoke(this.elements,"revert"),e=e?e:this._originalHtml||"",this.metrics.contentHeight=0,this.lastUsedElement=null,this.releaseAll(),this.el.innerHTML=e,this._originalHtml=e},_addElement:function(e){var t;return e=this._verifyElementIsUsable(e),!e||!this.isFlexible&&0===this.metrics.height?!0:0!==this.metrics.contentHeight&&e.el&&e.$el.hasClass(b["default"].BREAK_BEFORE)?!1:(this._verifyElementMetrics(e),t=this.getOverflow(e.metrics),this.isFlexible||-1*t>=this.metrics.lineHeight?(this._useElement(e),!0):t>-this.metrics.lineHeight&&t<=e.metrics.marginBottom?(e.shouldStickToNext()||this._useElement(e),!1):this._overflowElementIfSupported(e))},_useElement:function(e){var t=0;this.lastUsedElement&&(t=Math.min(this.lastUsedElement.metrics.marginBottom,e.metrics.marginTop));var n=e.metrics.outerHeight-t;this.metrics.contentHeight+=n,this.fragment.appendChild(e.render().el),this.retain(e.figure||e),this.lastUsedElement=e,e instanceof f["default"]&&this._contentContainers.push(e)},_overflowElementIfSupported:function(e){var t,n,i=e.isRearrangeable();return i||e.isSplittable()?i?(this.anchoredBlock=e,!0):(t=this.metrics.height-this.metrics.contentHeight,this._useElement(e),n=e.getOverflowBlock(t).render(),this.content.addAfter(n,this.anchoredBlock||this.lastUsedElement),this.anchoredBlock=null,!1):!1},_verifyElementIsUsable:function(e){if(e instanceof m["default"])return e;if(e instanceof p["default"]&&!this._originalContainers)return!1;var t,n;return r["default"].each(this._originalContainers,function(i){return t=e.getElementMappedToField(i.fieldMap),t?(n=i,!1):void 0}),t?(n=n.clone(),n.isInline=!0,n.content=this.content,n.setFigure(e,t),this.$el.append(n.render().el),n.calculateMetrics(),n.metrics.lineHeight=this.metrics.lineHeight,this.options.isPositionedGrid&&n.normalize(this.metrics.lineHeight,this.lastUsedElement&&this.lastUsedElement.metrics.marginBottom),n.releaseAll(),n.$el.remove(),n):!1},_verifyElementMetrics:function(e){e.metrics.lineHeight!==this.metrics.lineHeight&&_["default"].console.warn("lineHeight mismatch between page and content.","lineHeight on ",this.el,": ",this.metrics.lineHeight,"lineHeight on ",e.el,": ",e.metrics.lineHeight,"The page might not look good!"),this.options.isPositionedGrid&&e.normalize(this.metrics.lineHeight,this.lastUsedElement&&this.lastUsedElement.metrics.marginBottom)},_getInlineContainers:function(){return r["default"].map(this.$el.find("."+b["default"].CONTAINER_INLINE),function(e){return new f["default"]({el:e})})}}),exports["default"]=w},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={retain:function(e){this.content.retain(e),this.retained=this.retained||[],this.retained.push(e)},releaseAll:function(){this.retained&&this.retained.length&&(this.content.release(this.retained),this.retained=[])},didRetainElements:function(){return!!this.retained&&this.retained.length>0}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(12),l=n(o),u=t(15),c=n(u),h=t(34),f=n(h),d=t(43),p=n(d),g=t(13),m=n(g),v=t(9),_=n(v),y=t(26),b=n(y),w=t(41),E=n(w),T=l["default"].extend();T.loadedAssets=[],r["default"].extend(T.prototype,f["default"],p["default"],{fullscreenEvents:{touch:{"touchstart img, .alf-image":"onTouchStart","touchmove img, .alf-image":"onTouchMove","touchend img, .alf-image":"onTouchEnd","tap img, .alf-image":"onTap"},pointer:{"click img, .alf-image":"onClick","mousedown img, .alf-image":"onMouseDown"}},className:m["default"].CONTAINER,initialize:function(e){e=this.options=r["default"].extend({},e||{}),r["default"].bindAll(this,"load","_doLoad","_loadComplete","_loadReady","enterFullscreen"),this.defaultMetrics(),this.deferreds=[],this.loaded=null,this.isDirty=!1,this.isResponsive=!1,this.mouseDownX=0,this.mouseDownY=0,this.mouseDownTime=0,this.matchingFigureElements=[],this._lastState={},e.pixelRatio=parseInt(e.pixelRatio||window.devicePixelRatio||1,10)},tearDown:function(){this.releaseAll(),this.stopListening(),this.undelegateEvents(),this.el=null,this.figureEl=null,this.fullscreenEl&&(0,a["default"])(this.fullscreenEl).remove(),this.fullscreenEl=null,this.$el.find("img").each(function(){this.style.removeProperty("max-width"),this.style.removeProperty("max-height"),this.style.removeProperty("width"),this.style.removeProperty("height")})},remove:function(){this.$el.addClass(m["default"].IS_REMOVED),this.isRemoved=!0,this.releaseAll(),this.figure=null,this.figureEl=null,this.$el.empty()},clone:function(){var e;return e=new T({el:this.el.cloneNode(!0)}),e._setUniqueId(),e},setElement:function(e){T.__super__.setElement.call(this,e),this.fieldMap=b["default"].dom.getFieldMap(this.el),this.ref=this.el.dataset.ref,this.isOptional=this.$el.hasClass(m["default"].IS_OPTIONAL),this.isRemoved=this.$el.hasClass(m["default"].IS_REMOVED),this.type=this.$el.attr("data-type")},setFigure:function(e,t){return this.figureElSignature&&this.figureElSignature!==t.signature&&this.revert(),this.figure=e,this.figureEl=t,this.figureElSignature=t.signature,this.retain(e),this},setFigureEl:function(e){this.setFigure(e.figure,e)},lockFigureEl:function(){this.preferFigureElSignature=this.figureElSignature},useBestMatchingFigureEl:function(){var e=this;if(!this.matchingFigureElements.length)return!1;var t;return this.preferFigureElSignature&&(t=r["default"].find(this.matchingFigureElements,function(t){return t.matchesAnySignature(e.preferFigureElSignature)})),this.setFigureEl(t||this.matchingFigureElements[0]),!0},useNextFigureEl:function(){var e=this.matchingFigureElements.length;if(!e)return!1;var t=this.matchingFigureElements.indexOf(this.figureEl)+1;return this.setFigureEl(this.matchingFigureElements[t%e]),this.lockFigureEl(),!0},setLayer:function(e){this.layer=e,this.fullscreenLayer||(this.fullscreenLayer=e.above()),this._setupFullscreen()},setFullscreenEl:function(e){this.fullscreenEl=e,this._setupFullscreen()},preventDefaultEvents:function(){this.undelegateEvents(this.fullscreenEvents)},isSplittable:function(){return!1},isRearrangeable:function(){return this.$el.hasClass(m["default"].IS_REARRANGEABLE)?!0:!1},render:function(){return this.isReadyForRender()?(this.id=this.el.id||this._setUniqueId(),this.rendered=!0,this.isUsingSameFigureEl()?(this.$el.append(this._lastState.html),this.renderedWidgets=this._lastState.renderedWidgets||!1):(this.renderProcessedContainerContent(),this.renderBgImages(),this._originalHtml=this.el.outerHTML),this.matchingFigureElements&&this.matchingFigureElements.length>1&&this.$el.addClass(m["default"].MULTI_CHOICE),this):this},isReadyForRender:function(){return this.figureEl&&!this.rendered&&!this.isDisabled&&!this.isRemoved},renderProcessedContainerContent:function(){var e=this.figureEl.el.outerHTML,t=this.el.dataset.select||this.el.dataset.selectInner,n=t?this.$el:(0,a["default"])(this.el).find("[data-select], [data-select-inner]");return 0===n.length?this.$el.append(e):void n.each(function(t,n){var i,r=n.dataset.select,s=!1;r||(r=n.dataset.selectInner,s=!0);try{i=(0,a["default"])(e).find(r)[0]}catch(o){}i?n.innerHTML=s?i.innerHTML:i.outerHTML:n.parentNode.removeChild(n)})},renderBgImages:function(){var e=this;if("image"===this.type){var t=this.$el.find("img");t.length&&t.each(function(t,n){var i=n.getAttribute("data-src")||n.getAttribute("src"),r=n.getAttribute("data-src-2x"),s=parseInt(n.getAttribute("width"),10),o=parseInt(n.getAttribute("height"),10),l=o/s,u={width:"100%","padding-bottom":100*l+"%","background-image":"url("+i+")","background-repeat":"no-repeat","background-size":"cover","background-position":"50% 50%"},c={"data-ratio":l,"data-width":s,"data-height":o,"data-src":n.getAttribute("data-src")};r&&(c["data-src-2x"]=r);var h=(0,a["default"])("<div>").attr(c).addClass(m["default"].IMAGE).css(u);(0,a["default"])(n).replaceWith(h),e._trackAssetProgress(i)})}},discard:function(){this.rendered=!1,this._lastState={},this.$el.empty(),this.render(),this.renderedWidgets=!1,this.renderWidgets(),this.unload(),this.load()},revertToOriginal:function(){this.$el.html(this._originalHtml)},revert:function(){this.rendered&&this.saveState(),this._originalHtml=!1,this.rendered=!1,this.renderedWidgets=!1,this.figure=null,this.figureEl=null,this.fullscreenEl=null,this.fullscreenLoaded=!1,this.releaseAll(),this.$el.empty(),this.enable()},isUsingSameFigureEl:function(){var e=this.figureEl.matchesAnySignature(this._lastState.figureElSignature);return e||this.isUsingSimilarFigureEl()},isUsingSimilarFigureEl:function(){if(!this._lastState.html||1!==this.matchingFigureElements.length)return!1;var e=(0,a["default"])(this._lastState.html);return e.find("img").length?!1:e[0].tagName!==this.figureEl.el.tagName?!1:!0},saveState:function(e){this._lastState=r["default"].extend({html:this.el.innerHTML,figureElSignature:this.figureElSignature,preferFigureElSignature:this.preferFigureElSignature,renderedWidgets:this.renderedWidgets},e||{})},load:function(){E["default"].all(this._runWidgets(),this._doLoad)},unload:function(){this.loaded!==!1&&(this.loaded=!1,this.unloadElement(this.el))},unloadElement:function(e){var t=(0,a["default"])(e);t.addClass(m["default"].CONTAINER_IS_UNLOADED),t.find("img[data-src]").each(function(){this.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==")})},addDeferred:function(e){this.deferreds.push(e)},shouldStickToNext:function(){return!1},enterFullscreen:function(e){if(!this._supportsFullscreen)return b["default"].console.warn("This container does not support fullscreen"),this.layer||b["default"].console.warn("  Missing layer"),void(this.fullscreenEl||b["default"].console.warn("  Missing fullscreenEl"));var t=this.transition;return this.gestureStarted||t.isRunning()?!1:(this.layer.transition=t,e&&e instanceof HTMLElement&&t.setTargetEl(e),void t.run())},_setupFullscreen:function(){!this._supportsFullscreen&&this.fullscreenEl&&this.layer&&this.fullscreenLayer&&(this.transition=this.transition||this.layer.transitionTo(this.fullscreenLayer,c["default"].Fade),this.$el.addClass(m["default"].SUPPORTS_FULLSCREEN),this.listenTo(this.transition,{willAppear:this._fullscreenWillAppear,didAppear:this._fullscreenDidAppear,didDisappear:this._fullscreenDidDisappear}),this.layer.transition=this.transition,this.delegateEvents(b["default"].touchScreen?this.fullscreenEvents.touch:this.fullscreenEvents.pointer),this._supportsFullscreen=!0)},_setUniqueId:function(e){return e||(e=r["default"].uniqueId("c")),this.id=e,this.el.id=e,e},renderWidgetMatch:function(e){e.widget.render.call(e,this,e.el),e.widget.compile||(this.isDirty=!0)},renderWidgets:function(){return this.renderedWidgets?!1:(r["default"].each(this.matchingWidgets,function(e){(!this.decompiled||this.decompiled&&!e.widget.compile)&&this.renderWidgetMatch(e)},this),void(this.renderedWidgets=!0))},_runWidgets:function(){var e,t=[];return r["default"].each(this.matchingWidgets,function(n){e=E["default"].defer(),n.widget.compile||(this.isDirty=!0),n.widget.run.call(n,e.resolve),t.push(e)},this),t},_doLoad:function(){var e,t=this,n=Math.min(this.options.pixelRatio,2);return this.loaded?void 0:(this.$el.hasClass(m["default"].ALLOW_OVERFLOW)||this._fitBoundaries(),this.$assets=this.$el.find("img[data-src]"),e="data-src"+(n>1?"-"+n+"x":""),r["default"].each(this.$assets,function(n){var i=n.getAttribute(e)||n.getAttribute("data-src");t._trackAssetProgress(i||n.getAttribute("src"),n),i&&(n.src=i)}),E["default"].any(this.deferreds,this._loadReady),E["default"].all(this.deferreds,this._loadComplete),this.loaded=!0,this)},_fullscreenWillAppear:function(e,t){this.trigger("fullscreenWillAppear",e,t)},_fullscreenDidAppear:function(e){this.trigger("fullscreenDidAppear",e)},_fullscreenDidDisappear:function(e){this.trigger("fullscreenDidDisappear",this),_["default"].trigger("fullscreenDidDisappear",this)},_loadReady:function(){this.$el.removeClass(m["default"].CONTAINER_IS_UNLOADED)},_loadComplete:function(){this.trigger("loadComplete")},_trackAssetProgress:function(e,t){var n=this,i=E["default"].defer();this.addDeferred(i),-1!==T.loadedAssets.indexOf(e)?i.resolve({},t):(t||(t=new Image,t.src=e),t.addEventListener("load",function(t){T.loadedAssets.push(e),i.resolve(t,t.currentTarget)}),t.addEventListener("error",function(t){i.resolve(t,t.currentTarget),_["default"].trigger("assetLoadError",n,e)}))},_fitBoundaries:function(){var e=[],t=this;this.decompiled||this.isResponsive||(this.$el.find("img").each(function(){var n,i=this.clientWidth,r=this.clientHeight;i>t.metrics.width&&(n=t.metrics.width/i,e.push({el:this,css:{height:r*n+"px",width:t.metrics.width+"px"}}))}),r["default"].each(e,function(e){(0,a["default"])(e.el).css(e.css)}))},onTouchStart:function(e){e=e.originalEvent||e;var t=e.touches[0];this._touchStartX=t.pageX,this._touchStartY=t.pageY,this._touchMoveX=t.pageX,this._touchMoveY=t.pageY},onTouchMove:function(e){e=e.originalEvent||e;var t=e.touches[0];this._touchMoveX=t.pageX,this._touchMoveY=t.pageY},onTouchEnd:function(e){var t,n;t=Math.abs(this._touchStartX-this._touchMoveX),n=Math.abs(this._touchStartY-this._touchMoveY),7>t&&7>n&&e.preventDefault()},onMouseDown:function(e){this.mouseDownX=e.pageX,this.mouseDownY=e.pageY,this.mouseDownTime=Date.now()},onTap:function(e){this.enterFullscreen(e.currentTarget)},onClick:function(e){var t=Math.abs(e.pageX-this.mouseDownX),n=Math.abs(e.pageY-this.mouseDownY),i=Date.now()-this.mouseDownTime;t>5||n>5||i>1500||this.enterFullscreen(e.currentTarget)},onGestureStart:function(e){var t=this.transition;return this.gestureStarted||t.isRunning()?!1:(this.gestureStarted=!0,t.setTargetEl(e.currentTarget),void this.startTransform(e))},onGestureChange:function(e){var t=this.transition;return t.isRunning()?!1:void this.transformEventTarget(e)},onGestureEnd:function(e){var t=this.transition;return t.isRunning()?!1:(t.run(),void(this.gestureStarted=!1))}}),exports["default"]=T},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return o["default"].map(e,p)}function r(e){if(-1===e.indexOf("*"))return new RegExp("^"+e+"$");var t=e.replace(/([\-\:])/g,"\\$1");return t=t.replace(/(^|[^\\W\*])\*(\\|$)/g,"$1[^\\W]+$2"),t=t.replace(/(^|[^\\W])\*\*(\\|$)/g,"$1(.*)?$2"),new RegExp("^"+t+"$")}function s(e,t){return o["default"].find(t,function(t){return t.match(e)})}Object.defineProperty(exports,"__esModule",{value:!0});var a=t(1),o=n(a),l=t(12),u=n(l),c=t(13),h=n(c),f=t(46),d=n(f),p=o["default"].memoize(r),g=o["default"].memoize(s,function(e,t){return[e,t]}),m=u["default"].extend({initialize:function(){var e=this;this.elements=o["default"].map(this.$el.children("[data-map]"),function(t,n){var i=new d["default"]({el:t,figure:e});return i.lockSignature(),i})},setElement:function(e){m.__super__.setElement.call(this,e),this.isOptional=this.$el.hasClass(h["default"].IS_OPTIONAL)},getElementMappedToField:function(e){var t=!1,n=!1;return o["default"].each(i(e),function(e){return(t=o["default"].find(this.elements,function(t){return g(e,t.fieldMap)}))?t.noScore?(n=n||t,void(t=!1)):!1:void 0},this),t||n},getElementsMappedToField:function(e){var t=this,n=o["default"].map(i(e),function(e){return o["default"].filter(t.elements,function(t){return g(e,t.fieldMap)})}),r=o["default"].flatten(n);return r=r.sort(function(e,t){return e.noScore===t.noScore?0:t.noScore?-1:1})}});exports["default"]=m},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(12),r=n(i),s=t(13),a=n(s),o=t(26),l=n(o),u=r["default"].extend({initialize:function(e){this.figure=e.figure},setElement:function(e){u.__super__.setElement.call(this,e),this.noScore=this.$el.hasClass(a["default"].NO_SCORE),this.fieldMap=l["default"].dom.getFieldMap(this.el)}});exports["default"]=u},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(12),l=n(o),u=t(34),c=n(u),h=t(13),f=n(h),d=l["default"].extend();r["default"].extend(d.prototype,c["default"],{tagName:"p",isInline:!0,initialize:function(e){e=e||{},this.isOverflow=!1,this.isDirty=!1,this.originalMetrics=null,e.metrics||this.defaultMetrics()},render:function(){if(this.isRendered)return this;if(this.isFirst&&this.$el.addClass(f["default"].IS_FIRST_BLOCK),this.isLast&&this.$el.addClass(f["default"].IS_LAST_BLOCK),this.isOverflow){var e=(0,a["default"])('<div style="overflow:hidden;padding:0;"></div>');e.css("margin-bottom",this.metrics.marginBottom+"px").addClass(f["default"].IS_SPLITTABLE).addClass(f["default"].IS_NON_REARRANGEABLE).append(this.el),this.$el.css("margin-bottom","0px"),this.setElement(e[0]),this.isDirty=!0}return this.isRendered=!0,this},clone:function(){var e=new d({el:this.el.cloneNode(!0)});return e.clonedFrom=this,e.metrics=r["default"].extend({},this.metrics),e.isLast=this.isLast,this.isDirty&&e.$el.removeAttr("style"),e},revert:function(){this.isDirty&&(this.isOverflow||this.el.style.removeProperty("overflow"),this.el.style.removeProperty("height"),this.isDirty=!1)},isSplittable:function(){return this.$el.hasClass(f["default"].IS_NON_SPLITTABLE)?!1:this.$el.hasClass(f["default"].IS_SPLITTABLE)||-1!==["P","UL","OL"].indexOf(this.el.tagName)},isRearrangeable:function(){return this.$el.hasClass(f["default"].IS_NON_REARRANGEABLE)?!1:this.$el.hasClass(f["default"].IS_REARRANGEABLE)||-1!==["DIV"].indexOf(this.el.tagName)},shouldStickToNext:function(){return this.$el.hasClass(f["default"].STICK_TO_NEXT)||-1!==["H1","H2","H3"].indexOf(this.el.tagName)},getOverflowBlock:function(e){var t,n,i=0;n=this.clone(),this.isOverflow&&n.setElement(n.$el.children().first()),n._isNormalized=!1,n.isOverflow=!0,n.overflowMarginTop=this.isOverflow?this.metrics.overflowMarginTop:0,t=e%this.metrics.lineHeight,i=e-t,this.$el.css({overflow:"hidden",height:i+"px"}),this.isDirty=!0;var r=n.overflowMarginTop;return n.$el.css("margin-top",r-i+"px"),n.metrics.height-=i,n.metrics.outerHeight-=i,n.metrics.overflowMarginTop=r-i,n}}),exports["default"]=d},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(12),a=n(s),o=t(34),l=n(o),u=t(26),c=n(u),h=t(13),f=n(h),d=t(9),p=n(d),g=t(41),m=n(g),v=a["default"].extend();r["default"].extend(v.prototype,l["default"],{initialize:function(e){e=this.options=r["default"].extend({},e||{}),this.layer=this.options.layer||null},tearDown:function(){this.stopListening(),this.$el.remove()},subscribeToContainer:function(e){var t;!e.fullscreenEl&&e.figure&&(t=this.getFullscreenElement(e.figure),t&&e.setFullscreenEl(t)),this.listenTo(e,{fullscreenWillAppear:function(t,n){this._loadMathchingWidgetsForContainer(e,n)}})},getFullscreenElement:function(e){var t=c["default"].dom.getFieldMap(this.el),n=e.getElementMappedToField(t);return n?n.el.cloneNode(!0):null},loadContainer:function(e,t){if(!this.layer)return void c["default"].console.warn("No fullscreen layer found");var n,i=function(){e.fullscreenLoaded=!0,t()};return this.$el.empty().addClass(f["default"].IS_VISIBLE).append(e.fullscreenEl),this.layer.renderFullscreenContainer(this),e.fullscreenLoaded?i():(n=this.layer.$el.find("img[data-src]"),n.length||i(),void n.each(function(){this.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",this.addEventListener("load",i),this.src=this.getAttribute("data-src")}))},exitFullscreen:function(){this.layer.exitFullscreen()},_loadMathchingWidgetsForContainer:function(e,t){var n,i=[];return n=function(){p["default"].trigger("fullscreenWillAppear",e),t()},e.matchingWidgets&&e.matchingWidgets.length?(i.push(m["default"].defer()),this.loadContainer(e,i[0].resolve),r["default"].each(e.matchingWidgets,function(e){var t=m["default"].defer();i.push(t),e.widget.fullscreen.call(e,this,t.resolve)},this),void m["default"].all(i,n)):this.loadContainer(e,n)}}),exports["default"]=v},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(13),l=n(o),u=t(41),c=n(u),h=t(12),f=n(h),d=r["default"].memoize(function(e){if(!e)return{};var t=e.replace(/\s+/g,"").split(";"),n={};return r["default"].each(t,function(e){var t=e.split(":"),i=t[0],r=parseInt(t[1],10);isNaN(r)&&(r="false"!==t[1]),n[i]=r}),n}),p=f["default"].extend();r["default"].extend(p.prototype,{tagName:"object",className:l["default"].SIZE_DETECTOR,initialize:function(e){e=this.options=r["default"].extend({start:300,end:1200,interval:50,refreshRate:50,watch:!0,target:null},e||{}),this.$target=(0,a["default"])(this.options.target),r["default"].extend(this.options,d(this.$target.attr("data-respond"))),r["default"].bindAll(this,"_onResize","_setupListenerForView"),this._onResize=r["default"].throttle(this._onResize,e.refreshRate),this._deferred=c["default"].defer(),this.isReady=this._deferred.promise},start:function(){this._setupListenerForView()},tearDown:function(){var e=this.el.contentDocument;e&&e.defaultView&&e.defaultView.removeEventListener("resize",this._onResize),this.$el.remove()},render:function(){if(!this.options.watch)return this._applyClassNamesForWidth(this.$target.width()),this._deferred.resolve(),this;var e=this.$target.find("."+l["default"].SIZE_DETECTOR);return e.length?(this.setElement(e),this.start(),this):(this.$el.css({display:"block",position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%","pointer-events":"none","z-index":-2147483648}),this.el.type="text/html",this.el.data="about:blank",this.start(),this.$target.append(this.$el),this)},getClassNamesForWidth:function(e){for(var t=this.options,n=t.start,i=t.end,r=t.interval,s=[],a=n;i>=a;a+=r)e>a?s.push("alf-gt"+a):s.push("alf-lt"+a);return s},_onResize:function(e){var t=e.target.innerWidth;this._applyClassNamesForWidth(t)},_setupListenerForViewOnLoad:function(){this.$el.on("load",r["default"].bind(function(){setTimeout(this._setupListenerForView,0),this.$el.off("load")},this))},_setupListenerForView:function(){if(!this.el.contentDocument)return void this._setupListenerForViewOnLoad();var e=this.el.contentDocument.defaultView;e.addEventListener("resize",this._onResize),this._applyClassNamesForWidth(e.innerWidth),this._deferred.resolve()},_applyClassNamesForWidth:function(e){var t=this.getClassNamesForWidth(e);if(this.options.target){var n=(0,a["default"])(this.options.target).get(0),i=n.className;i=a["default"].trim(i.replace(/alf\-(g|l)t(\d+)\s?/g,"")),i+=" "+t.join(" "),n.className=i}this.trigger("resize",e)}}),exports["default"]=p},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(6),r=n(i),s=function(e){var t;this.options=r["default"].extend({prefix:""},e),this.el=e.el,this.height=e.height||(0,r["default"])(this.el).height(),this.lineHeight=e.lineHeight||0,t=window.getComputedStyle(this.el,null),this.paddingTop=parseInt(t.getPropertyValue("padding-top"),10),this.paddingBottom=parseInt(t.getPropertyValue("padding-bottom"),10),this.height-=this.paddingTop+this.paddingBottom,this._position()};s.prototype._position=function(){var e=this,t=[],n=this.el.className.match(/cols\-([0-9]+)/);if(!n)throw new Error("Failed to find number of columns");n=parseInt(n[1],10);for(var i=0;n>i;i++)t[i]={remainingHeight:this.height,cells:[]};(0,r["default"])(this.el).find('[class*="col-"]').each(function(){var n=parseInt(this.className.match(/col\-([0-9]+)/)[1],10)-1,i=this.className.match(/colspan\-([0-9]+)/),s=e._createCellFromEl(this);if(i=i?parseInt(i[1],10):1,"none"!==(0,r["default"])(this).css("display"))for(var a=n;n+i>a;a++)t[a].cells.push(s)}),this._calcMetrics(t),r["default"].each(t,function(t,n){e._positionColumn(t,n)})},s.prototype._createCellFromEl=function(e){var t=(0,r["default"])(e).hasClass(this._class("flex"));return{el:e,flex:t,height:0,innerHeight:0,top:0}},s.prototype._calcMetrics=function(e){var t,n,i,s,a,o,l,u,c,h;for(t=this._class("col-top"),n=this._class("col-bottom"),i=e.length,l=0;i>l;l++)for(s=e[l].cells.length,u=0;s>u;u++)a=e[l].cells[u],o=(0,r["default"])(a.el),o.removeClass(t+" "+n),0===u&&(a.isTop=!0,o.addClass(t)),u===s-1&&(a.isBottom=!0,o.addClass(n));for(l=0;i>l;l++)for(s=e[l].cells.length,u=0;s>u;u++)a=e[l].cells[u],o=(0,r["default"])(a.el),a.height=a.flex?0:o.outerHeight(),a.isTop&&(c=window.getComputedStyle(a.el,null),e[l].marginTop=parseInt(c.getPropertyValue("margin-top"),10),e[l].marginTopOffset=e[l].marginTop%this.lineHeight,a.flex||(a.innerHeight=o.height(),0===a.innerHeight&&(h=parseInt(c.getPropertyValue("margin-bottom"),10),a.height-=h))),e[l].remainingHeight-=a.height},s.prototype._positionColumn=function(e,t){var n=this,i=this.paddingTop;r["default"].each(t.cells,function(e,s){var a=(0,r["default"])(s.el),o={},l=0;if(!n.lineHeight||s.isTop||s.isBottom&&!s.flex||(l=(i-t.marginTopOffset-n.paddingTop)%n.lineHeight,0!==l&&(l=n.lineHeight-l,t.remainingHeight-=l,i+=l)),(!s.isTop||s.top<i)&&(s.top=i),o.top=s.top+"px",s.flex){var u=parseInt(a.css("margin-bottom"),10)+parseInt(a.css("margin-top"),10);s.height=t.remainingHeight,o.height=(s.height>u?s.height-u:0)+"px"}a.css(o),i+=s.height})},s.prototype._class=function(e){return this.options.prefix+e},"undefined"!=typeof window&&(r["default"].fn.grid=function(e){return e=e||{},e.el=this[0],new s(e)}),exports["default"]=s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(11),l=n(o),u=l["default"].extend({initialize:function(e){this.container=e,this.compiled={}},compile:function(){var e=this.container,t=(0,a["default"])(e.el.outerHTML);return e.isDirty&&e.revertToOriginal(),e.unloadElement(t),this.compiled={loaded:!1,metrics:e.metrics,html:t[0].outerHTML},e.fullscreenEl&&(this.compiled.fullscreenEl=e.fullscreenEl.outerHTML),this.compiled},decompile:function(e){var t=this.container;t.decompiled=!0,r["default"].extend(t,e),t.fullscreenEl&&t.setFullscreenEl((0,a["default"])(t.fullscreenEl).get(0))}});exports["default"]=u},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return{callback:e,name:t}}Object.defineProperty(exports,"__esModule",{value:!0});var r=t(1),s=n(r),a=t(53),o=n(a),l=t(54),u=n(l),c=t(55),h=n(c),f=t(26),d=n(f),p=t(40),g=n(p),m={filters:{article:s["default"].map(u["default"],i),page:s["default"].map(h["default"],i)},addArticleFilter:function(e,t){this.filters.article.push({callback:e,name:t||"articlefilter"})},addPageFilter:function(e,t){this.filters.page.push({callback:e,name:t||"pagefilter"})},getBestTemplateForPage:function(e,t){var n,i,r={score:-(1/0),template:null,containerMap:null};return s["default"].each(t,function(t){n=t.getContainerMap(e.content),i=t.score(e,n),(i>r.score||i===r.score&&Math.random()>.5)&&(r.score=i,r.template=t,r.containerMap=n)}),r},getEligibleTemplatesForArticle:function(e,t){return this._filterTemplates("article",e,t);
},getEligibleTemplatesForPage:function(e,t){return this._filterTemplates("page",e,t)},getScoredTemplatesForPage:function(e,t){return s["default"].map(this.getEligibleTemplatesForPage(e,t),function(t){return{template:t,score:t.score(e)}})},getPageTemplateFromTemplate:function(e,t){return new g["default"](s["default"].extend(t||{},{el:e.el.cloneNode(!0)}))},getTemplateFromPageTemplate:function(e,t){var n=new o["default"](s["default"].extend(t||{},{el:e.el.cloneNode(!0)}));return s["default"].each(n.regions,function(t,n){t.revert(e.regions[n]._originalHtml)}),s["default"].invoke(n.containers,"revert"),n},_filterTemplates:function(e,t,n){return t.pages?d["default"].console.groupCollapsed("** Filtering templates for article"):d["default"].console.groupCollapsed("** Filtering templates for page",t.pageNum+1),s["default"].each(this.filters[e],function(e){var i=n.slice(0);n=e.callback.call(this,t,n),d["default"].console.groupCollapsed("Filter `"+e.name+"` on",i.length,"templates (removed",i.length-n.length,"templates)"),i.length-n.length&&s["default"].each(i,function(e){-1===n.indexOf(e)&&d["default"].console.debug("-",e.name)}),d["default"].console.groupEnd()},this),d["default"].console.debug("Remaining templates:",n.length),d["default"].console.groupEnd(),n}};exports["default"]=m},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(12),a=n(s),o=t(42),l=n(o),u=t(44),c=n(u),h=t(45),f=n(h),d=t(13),p=n(d),g=-500,m=100,v=0,_=-500,y=100,b=5,w=a["default"].extend();r["default"].extend(w.prototype,{setElement:function(e){w.__super__.setElement.call(this,e),this.name=this.$el.attr("data-name"),this.signature=void 0,this.lockSignature(),this.containers=this.$el.find("."+p["default"].CONTAINER).map(function(){return new c["default"]({el:this})}),this.regions=this.$el.find("."+p["default"].REGION).map(function(){return new l["default"]({el:this})}),this.baseScore=parseInt(this.$el.attr("data-score")||0,10)},score:function E(e,t){var E=this.baseScore,n=e.content.getBlocks();return t=t||this.getContainerMap(e.content),E+=t.score||0,r["default"].each(t.positions,function(e){E+=e.match?e.noScore?0:m:e.isOptional?v:g}),this.regions.length&&(E+=n.length?y:_),this.lastScore=E,E},getContainerMap:function(e){var t,n,i,s=[],a={matches:0,positions:{},score:0,template:this};return t=e.getElements(),n=e.getFigures(),i=t.length,r["default"].each(this.containers,function(e,r){var o,l,u;for(u=a.positions[r]={match:!1,fieldMap:e.fieldMap,isOptional:e.isOptional||!e.fieldMap.length&&e.ref},o=0;i>o;o++)if(t[o]instanceof f["default"]&&-1===s.indexOf(t[o])&&(l=t[o].getElementMappedToField(e.fieldMap)))return a.score-=o*b,a.matches+=1,s.push(t[o]),u.match=!0,u.index=n.indexOf(t[o]),void(u.noScore=l.noScore)}),a}}),exports["default"]=w},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(26),a=n(s),o=!!a["default"].matchMedia;exports["default"]={mediaQuery:function(e,t){return o?r["default"].filter(t,function(e){var t=a["default"].dom.getMediaQuery(e.el);return t?a["default"].matchMedia(t).matches:!0}):t},fieldMap:function(e,t){var n,i=e.content.fieldMap;return i&&i.length?r["default"].filter(t,function(e){return n=a["default"].dom.getFieldMap(e.el),n.length?r["default"].intersection(i,n).length>0:!1}):t},emptyContainers:function(e,t){var n;return n=function(e){return e.match===!0||e.match===!1&&e.isOptional},r["default"].filter(t,function(t){var i=t.getContainerMap(e.content);return r["default"].every(i.positions,n)})},formatName:function(e,t){var n;return e.format&&(n=e.format.get("name"))?r["default"].filter(t,function(e){var t=e.$el.attr("data-filter-format-name");return t?-1!==t.split(" ").indexOf(n):!0}):t}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i);exports["default"]={emptyBlocks:function(e,t){var n=e.content.getBlocks(),i=e.content.getFigures();return n.length?t:r["default"].filter(t,function(e){var t=e.regions;return t.length?r["default"].any(t,function(e){return e.containers.length?r["default"].any(e.containers,function(e){return r["default"].any(i,function(t){return t.getElementMappedToField(e.fieldMap)})}):!1}):e})},emptyContainers:function(e,t){var n;return n=function(e){return e.match===!0||e.match===!1&&e.isOptional},r["default"].filter(t,function(t){var i=t.getContainerMap(e.content);return r["default"].every(i.positions,n)})},pagePosition:function(e,t){return r["default"].filter(t,function(t){var n=t.$el.attr("data-filter-page-pos"),i=e.pageNum+1,s=!1;return n?(n=n.split(" "),r["default"].each(n,function(e){var t=!1,n=parseInt(e,10);return"!"===e[0]&&(t=!0,n=parseInt(e.substr(1),10)),t&&n!==i||!t&&n===i?(s=!0,!1):void 0}),s):!0})}}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(26),l=n(o),u=t(38),c=n(u),h=t(47),f=n(h),d=t(45),p=n(d),g=c["default"].extend({defaults:{contents:{},meta:{}},initialize:function(e){e&&e.contents&&this._changeContents(),this.on("change:contents",this._changeContents),this.__defineGetter__("elementsLeft",this._getElementsLeft)},setElements:function(e){e=r["default"].filter(e,function(e){return"P"===e.tagName&&e.innerHTML.length<15&&!e.innerHTML.replace(/(\s+)?(<br(\s+)?\/?>)?(&nbsp;)?/gim,"")?!1:e}),this.elements=r["default"].map(e,function(e){var t={el:e};if("FIGURE"===e.tagName){var n=new p["default"](t);if(n.elements.length)return n}return new f["default"](t)});var t=this.getBlocks();t.length&&(t[0].isFirst=!0,t[t.length-1].isLast=!0)},addAfter:function(e,t){var n=this.elements;n.splice(n.indexOf(t)+1,0,e)},each:function(e,t){r["default"].each(this.elements,e,t||this)},release:function(e){e=r["default"].isArray(e)?e:[e],r["default"].each(e,function(e,t){e.retained=!1,e.clonedFrom&&!e.clonedFrom.retained?this.elements.splice(this.elements.indexOf(e),1):e.revert&&e.revert()},this)},releaseAll:function(){this.release(this.elements)},retain:function(e){var t=r["default"].isArray(e)?e:[e];r["default"].each(t,function(e){e.retained=!0})},retainAll:function(){r["default"].each(this.elements,function(e){e.retained=!0})},getElements:function(){return r["default"].filter(this.elements,function(e){return!e.retained})},getBlocks:function(){return r["default"].filter(this.elements,function(e){return!e.retained&&e instanceof f["default"]})},getFigures:function(){return r["default"].filter(this.elements,function(e,t){return!e.retained&&e instanceof p["default"]})},hasBlocksLeft:function(){return this.getBlocks().length>0},isEmpty:function(){return 0===this.elementsLeft},_changeContents:function(){var e,t;e=(0,a["default"])(this.get("contents").source),t=e.children(),this.className=e.attr("class"),this.fieldMap=l["default"].dom.getFieldMap(e[0]),this.setElements(t)},_getElementsLeft:function(){return r["default"].reduce(this.elements,function(e,t){return t.retained?e:e+1},0)}});exports["default"]=g},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(58),r=n(i);exports["default"]={Article:r["default"]}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(11),a=n(s),o=t(59),l=n(o),u=a["default"].extend({initialize:function(e){this.article=e},serialize:function(){return{pages:r["default"].map(this.article.pages,this._serializePage,this)}},unserialize:function(e){var t=[],n=new l["default"](null,this.article);return e="string"==typeof e?JSON.parse(e):e,r["default"].each(e.pages,function(e,i){e&&(e.pageNum=i,t.push(n.unserialize(e)))}),r["default"].each(t,function(e){this.article.pages[e.pageNum]=e,this.article.setTemplateForPageNum(e.template,e.pageNum)},this),this.article.revert(),this.article},_serializePage:function(e){var t=new l["default"](e,this.article);return t.serialize()}});exports["default"]=u},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(1),r=n(i),s=t(3),a=n(s),o=t(11),l=n(o),u=t(53),c=n(u),h=t(52),f=n(h),d=l["default"].extend({initialize:function(e,t){this.page=e,this.article=t},serialize:function(){var e=[],t=this.page;return this.article.overrideTemplates[t.pageNum]?(e=r["default"].map(t.pageTemplate.containers,function(e){return e.figureEl?{figureElementSignature:e.figureEl.signature,preferFigureElSignature:e.preferFigureElSignature,html:e.el.innerHTML}:null}),{template:{signature:t.template.signature,html:f["default"].getTemplateFromPageTemplate(t.pageTemplate).el.outerHTML},containers:e}):!1},unserialize:function(e){var t=e.template.signature,n=e.template.html,i=new c["default"]({el:(0,a["default"])(n)}),r=this._findOriginalTemplate(t);this.page=this.article.createPage(e.pageNum),this.page.setTemplate(r||i);var s=f["default"].getPageTemplateFromTemplate(i,{page:this.page});return this.page.setPageTemplate(s),this._restoreContainers(e),this.page},_findOriginalTemplate:function(e){return r["default"].find(this.article.templates,function(t){return t.matchesAnySignature(e)})},_restoreContainers:function(e){r["default"].each(this.page.pageTemplate.containers,function(t,n){var i=e.containers[n],r=i&&i.figureElementSignature;r&&(t.figureElSignature=r,t.preferFigureElSignature=i.preferFigureElSignature,t.saveState({html:i.html,renderedWidgets:!0}))})}});exports["default"]=d},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(35),r=n(i);exports["default"]={Article:r["default"]}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var i=t(32),r=n(i);exports["default"]={ScrollView:r["default"]}}])});